<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>R spatial | The CASA Blog Network</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://blogs.casa.ucl.ac.uk/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="http://blogs.casa.ucl.ac.uk/wp-content/themes/twentyfourteen/js/html5.js"></script>
	<![endif]-->
	<link rel="alternate" type="application/rss+xml" title="The CASA Blog Network » Feed" href="http://blogs.casa.ucl.ac.uk/feed/">
<link rel="alternate" type="application/rss+xml" title="The CASA Blog Network » Comments Feed" href="http://blogs.casa.ucl.ac.uk/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="The CASA Blog Network » R spatial Category Feed" href="http://blogs.casa.ucl.ac.uk/category/r-spatial/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/blogs.casa.ucl.ac.uk\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.3.1"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script type="text/javascript" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/wp-emoji-release.js"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="twentyfourteen-lato-css" href="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/css.css" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/genericons.css" type="text/css" media="all">
<link rel="stylesheet" id="twentyfourteen-style-css" href="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/style.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentyfourteen-ie-css'  href='http://blogs.casa.ucl.ac.uk/wp-content/themes/twentyfourteen/css/ie.css?ver=20131205' type='text/css' media='all' />
<![endif]-->
<script type="text/javascript" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/jquery_002.js"></script>
<script type="text/javascript" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/jquery-migrate.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://blogs.casa.ucl.ac.uk/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://blogs.casa.ucl.ac.uk/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 4.3.1">
<script src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/a.html" type="text/javascript"></script><style id="fourteen-colors" type="text/css">
		/* Custom accent color. */
		button,
		.button,
		.contributor-posts-link,
		input[type="button"],
		input[type="reset"],
		input[type="submit"],
		.search-toggle,
		.hentry .mejs-controls .mejs-time-rail .mejs-time-current,
		.hentry .mejs-overlay:hover .mejs-overlay-button,
		.widget button,
		.widget .button,
		.widget input[type="button"],
		.widget input[type="reset"],
		.widget input[type="submit"],
		.widget_calendar tbody a,
		.content-sidebar .widget input[type="button"],
		.content-sidebar .widget input[type="reset"],
		.content-sidebar .widget input[type="submit"],
		.slider-control-paging .slider-active:before,
		.slider-control-paging .slider-active:hover:before,
		.slider-direction-nav a:hover,
		.ie8 .primary-navigation ul ul,
		.ie8 .secondary-navigation ul ul,
		.ie8 .primary-navigation li:hover > a,
		.ie8 .primary-navigation li.focus > a,
		.ie8 .secondary-navigation li:hover > a,
		.ie8 .secondary-navigation li.focus > a {
			background-color: #500182;
		}

		.site-navigation a:hover {
			color: #500182;
		}

		::-moz-selection {
			background: #500182;
		}

		::selection {
			background: #500182;
		}

		.paging-navigation .page-numbers.current {
			border-color: #500182;
		}

		@media screen and (min-width: 782px) {
			.primary-navigation li:hover > a,
			.primary-navigation li.focus > a,
			.primary-navigation ul ul {
				background-color: #500182;
			}
		}

		@media screen and (min-width: 1008px) {
			.secondary-navigation li:hover > a,
			.secondary-navigation li.focus > a,
			.secondary-navigation ul ul {
				background-color: #500182;
			}
		}
	
			.contributor-posts-link,
			button,
			.button,
			input[type="button"],
			input[type="reset"],
			input[type="submit"],
			.search-toggle:before,
			.hentry .mejs-overlay:hover .mejs-overlay-button,
			.widget button,
			.widget .button,
			.widget input[type="button"],
			.widget input[type="reset"],
			.widget input[type="submit"],
			.widget_calendar tbody a,
			.widget_calendar tbody a:hover,
			.site-footer .widget_calendar tbody a,
			.content-sidebar .widget input[type="button"],
			.content-sidebar .widget input[type="reset"],
			.content-sidebar .widget input[type="submit"],
			button:hover,
			button:focus,
			.button:hover,
			.button:focus,
			.widget a.button:hover,
			.widget a.button:focus,
			.widget a.button:active,
			.content-sidebar .widget a.button,
			.content-sidebar .widget a.button:hover,
			.content-sidebar .widget a.button:focus,
			.content-sidebar .widget a.button:active,
			.contributor-posts-link:hover,
			.contributor-posts-link:active,
			input[type="button"]:hover,
			input[type="button"]:focus,
			input[type="reset"]:hover,
			input[type="reset"]:focus,
			input[type="submit"]:hover,
			input[type="submit"]:focus,
			.slider-direction-nav a:hover:before {
				color: #fff;
			}

			@media screen and (min-width: 782px) {
				.primary-navigation ul ul a,
				.primary-navigation li:hover > a,
				.primary-navigation li.focus > a,
				.primary-navigation ul ul {
					color: #fff;
				}
			}

			@media screen and (min-width: 1008px) {
				.secondary-navigation ul ul a,
				.secondary-navigation li:hover > a,
				.secondary-navigation li.focus > a,
				.secondary-navigation ul ul {
					color: #fff;
				}
			}
		
		/* Generated variants of custom accent color. */
		a,
		.content-sidebar .widget a {
			color: #500182;
		}

		.contributor-posts-link:hover,
		.button:hover,
		.button:focus,
		.slider-control-paging a:hover:before,
		.search-toggle:hover,
		.search-toggle.active,
		.search-box,
		.widget_calendar tbody a:hover,
		button:hover,
		button:focus,
		input[type="button"]:hover,
		input[type="button"]:focus,
		input[type="reset"]:hover,
		input[type="reset"]:focus,
		input[type="submit"]:hover,
		input[type="submit"]:focus,
		.widget button:hover,
		.widget .button:hover,
		.widget button:focus,
		.widget .button:focus,
		.widget input[type="button"]:hover,
		.widget input[type="button"]:focus,
		.widget input[type="reset"]:hover,
		.widget input[type="reset"]:focus,
		.widget input[type="submit"]:hover,
		.widget input[type="submit"]:focus,
		.content-sidebar .widget input[type="button"]:hover,
		.content-sidebar .widget input[type="button"]:focus,
		.content-sidebar .widget input[type="reset"]:hover,
		.content-sidebar .widget input[type="reset"]:focus,
		.content-sidebar .widget input[type="submit"]:hover,
		.content-sidebar .widget input[type="submit"]:focus,
		.ie8 .primary-navigation ul ul a:hover,
		.ie8 .primary-navigation ul ul li.focus > a,
		.ie8 .secondary-navigation ul ul a:hover,
		.ie8 .secondary-navigation ul ul li.focus > a {
			background-color: #6d1e9f;
		}

		.featured-content a:hover,
		.featured-content .entry-title a:hover,
		.widget a:hover,
		.widget-title a:hover,
		.widget_twentyfourteen_ephemera .entry-meta a:hover,
		.hentry .mejs-controls .mejs-button button:hover,
		.site-info a:hover,
		.featured-content a:hover {
			color: #6d1e9f;
		}

		a:active,
		a:hover,
		.entry-title a:hover,
		.entry-meta a:hover,
		.cat-links a:hover,
		.entry-content .edit-link a:hover,
		.post-navigation a:hover,
		.image-navigation a:hover,
		.comment-author a:hover,
		.comment-list .pingback a:hover,
		.comment-list .trackback a:hover,
		.comment-metadata a:hover,
		.comment-reply-title small a:hover,
		.content-sidebar .widget a:hover,
		.content-sidebar .widget .widget-title a:hover,
		.content-sidebar .widget_twentyfourteen_ephemera .entry-meta a:hover {
			color: #6d1e9f;
		}

		.page-links a:hover,
		.paging-navigation a:hover {
			border-color: #6d1e9f;
		}

		.entry-meta .tag-links a:hover:before {
			border-right-color: #6d1e9f;
		}

		.page-links a:hover,
		.entry-meta .tag-links a:hover {
			background-color: #6d1e9f;
		}

		@media screen and (min-width: 782px) {
			.primary-navigation ul ul a:hover,
			.primary-navigation ul ul li.focus > a {
				background-color: #6d1e9f;
			}
		}

		@media screen and (min-width: 1008px) {
			.secondary-navigation ul ul a:hover,
			.secondary-navigation ul ul li.focus > a {
				background-color: #6d1e9f;
			}
		}

		button:active,
		.button:active,
		.contributor-posts-link:active,
		input[type="button"]:active,
		input[type="reset"]:active,
		input[type="submit"]:active,
		.widget input[type="button"]:active,
		.widget input[type="reset"]:active,
		.widget input[type="submit"]:active,
		.content-sidebar .widget input[type="button"]:active,
		.content-sidebar .widget input[type="reset"]:active,
		.content-sidebar .widget input[type="submit"]:active {
			background-color: #8132b3;
		}

		.site-navigation .current_page_item > a,
		.site-navigation .current_page_ancestor > a,
		.site-navigation .current-menu-item > a,
		.site-navigation .current-menu-ancestor > a {
			color: #8132b3;
		}
	
		/* Higher contrast Accent Color against contrast color */
		.site-navigation .current_page_item > a,
		.site-navigation .current_page_ancestor > a,
		.site-navigation .current-menu-item > a,
		.site-navigation .current-menu-ancestor > a,
		.site-navigation a:hover,
		.featured-content a:hover,
		.featured-content .entry-title a:hover,
		.widget a:hover,
		.widget-title a:hover,
		.widget_twentyfourteen_ephemera .entry-meta a:hover,
		.hentry .mejs-controls .mejs-button button:hover,
		.site-info a:hover,
		.featured-content a:hover {
			color: #8031b2;
		}

		.hentry .mejs-controls .mejs-time-rail .mejs-time-current,
		.slider-control-paging a:hover:before,
		.slider-control-paging .slider-active:before,
		.slider-control-paging .slider-active:hover:before {
			background-color: #8031b2;
		}
	</style>		<!-- Meta Manager Start -->
				<!-- Meta Manager End -->
		<link href="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/socialwidgets.css" type="text/css" rel="stylesheet"></head>

<body class="archive category category-r-spatial category-521 group-blog masthead-fixed list-view footer-widgets">
<div id="page" class="hfeed site">
	
	<header id="masthead" class="site-header" role="banner">
		<div class="header-main">
			<h1 class="site-title"><a href="http://blogs.casa.ucl.ac.uk/" rel="home">The CASA Blog Network</a></h1>

			<div class="search-toggle">
				<a href="#search-container" class="screen-reader-text" aria-expanded="false" aria-controls="search-container">Search</a>
			</div>

			<nav id="primary-navigation" class="site-navigation primary-navigation" role="navigation">
				<button class="menu-toggle">Primary Menu</button>
				<a class="screen-reader-text skip-link" href="#content">Skip to content</a>
				<div class="nav-menu"><ul><li class="page_item page-item-5"><a href="http://blogs.casa.ucl.ac.uk/about/">About</a></li></ul></div>
			</nav>
		</div>

		<div id="search-container" class="search-box-wrapper hide">
			<div class="search-box">
				<form role="search" method="get" class="search-form" action="http://blogs.casa.ucl.ac.uk/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input class="search-field" placeholder="Search …" name="s" title="Search for:" type="search">
				</label>
				<input class="search-submit" value="Search" type="submit">
			</form>			</div>
		</div>
	</header><!-- #masthead -->

	<div id="main" class="site-main">

	<section id="primary" class="content-area">
		<div id="content" class="site-content" role="main">

			
			<header class="archive-header">
				<h1 class="archive-title">Category Archives: R spatial</h1>

							</header><!-- .archive-header -->

			
<article id="post-69363" class="post-69363 post type-post status-publish format-standard has-post-thumbnail hentry category-918 category-census category-commute category-flows category-ggplot2 category-r category-r-spatial category-resources category-rstats category-spatial-analysis category-visualisation">
	
	<a class="post-thumbnail" href="http://spatial.ly/2015/03/mapping-flows/" aria-hidden="true">
		</a>

	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://blogs.casa.ucl.ac.uk/category/2011/" rel="category tag">2011</a>, <a href="http://blogs.casa.ucl.ac.uk/category/census/" rel="category tag">census</a>, <a href="http://blogs.casa.ucl.ac.uk/category/commute/" rel="category tag">commute</a>, <a href="http://blogs.casa.ucl.ac.uk/category/flows/" rel="category tag">flows</a>, <a href="http://blogs.casa.ucl.ac.uk/category/ggplot2/" rel="category tag">ggplot2</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r/" rel="category tag">R</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-spatial/" rel="category tag">R spatial</a>, <a href="http://blogs.casa.ucl.ac.uk/category/resources/" rel="category tag">Resources</a>, <a href="http://blogs.casa.ucl.ac.uk/category/rstats/" rel="category tag">rstats</a>, <a href="http://blogs.casa.ucl.ac.uk/category/spatial-analysis/" rel="category tag">spatial analysis</a>, <a href="http://blogs.casa.ucl.ac.uk/category/visualisation/" rel="category tag">visualisation</a></span>
		</div>
		<h1 class="entry-title"><a href="http://spatial.ly/2015/03/mapping-flows/" rel="bookmark">Mapping Flows in R</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://spatial.ly/2015/03/mapping-flows/" rel="bookmark"><time class="entry-date" datetime="2015-03-30T15:29:58+00:00">Monday 30 March 2015</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://blogs.casa.ucl.ac.uk/author/james/" rel="author">James Cheshire</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p><a href="http://spatial.ly/wp-content/uploads/2014/07/journey_to_work_web.gif"><img class="alignnone size-full wp-image-5099" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/journey_to_work_web.gif" alt="journey_to_work_web" height="1535" width="1313"></a></p>
<p>Last year I published the above graphic, which then got converted into the below&nbsp;for the book <a href="http://theinformationcapital.com/">London: The Information Capital</a>. I have had many requests for the code I used to create the plot so here it is!</p>
<p>The data shown is the Office for National Statistics flow data. <a href="https://www.nomisweb.co.uk/query/construct/components/simpleapicomponent.aspx?menuopt=12070&amp;subcomp=">See here for the latest version</a>. The file I used for the above can be downloaded <a href="http://127.0.0.1:8080/report/wu03ew_v1.csv.zip">here</a> (it is &gt;109 mb uncompressed so you need a decent computer to load/plot it all at once in R). You will also <a href="http://127.0.0.1:8080/report/msoa_popweightedcentroids.csv">need this file</a> of area (MSOA) codes and their co-ordinates. The code used is pasted below with comments above each segment. Good luck!<br>
<code><br>
library(plyr)<br>
library(ggplot2)<br>
library(maptools)<br>
</code></p>
<p>Load the flow data required – origin and destination points are needed. See above for where you can get the table used here.<br>
<code><br>
input&lt;-read.table("wu03ew_v1.csv", sep=",", header=T)<br>
</code><br>
We only need the first 3 columns of the above<br>
<code><br>
input&lt;- input[,1:3]<br>
names(input)&lt;- c("origin", "destination","total")<br>
</code></p>
<p>The UK Census file above didn't have coordinates just area codes. Here is a lookup that provides those. See above for download.<br>
<code><br>
centroids&lt;- read.csv("msoa_popweightedcentroids.csv")<br>
</code></p>
<p>Lots of joining to get the xy coordinates joined to the origin and then the destination points.<br>
<code><br>
or.xy&lt;- merge(input, centroids, by.x="origin", by.y="Code")<br>
names(or.xy)&lt;- c("origin", "destination", "trips", "o_name", "oX", "oY")<br>
dest.xy&lt;-  merge(or.xy, centroids, by.x="destination", by.y="Code")<br>
names(dest.xy)&lt;- c("origin", "destination", "trips", "o_name", "oX", "oY","d_name", "dX", "dY")<br>
</code></p>
<p>Now for plotting with ggplot2.This first step removes the axes in the resulting plot.<br>
<code><br>
xquiet&lt;- scale_x_continuous("", breaks=NULL)<br>
yquiet&lt;-scale_y_continuous("", breaks=NULL)<br>
quiet&lt;-list(xquiet, yquiet)<br>
</code></p>
<p>Let's build the plot. First we specify the dataframe we need, with a filter excluding flows of &lt;10<br>
<code><br>
ggplot(dest.xy[which(dest.xy$trips&gt;10),], aes(oX, oY))+<br>
</code><br>
The next line tells ggplot that we wish to plot line segments. The "alpha=" is line transparency and used below<br>
<code><br>
geom_segment(aes(x=oX, y=oY,xend=dX, yend=dY, alpha=trips), col="white")+<br>
</code><br>
Here is the magic bit that sets line transparency - essential to make the plot readable<br>
<code><br>
scale_alpha_continuous(range = c(0.03, 0.3))+<br>
</code><br>
Set black background, remove axes and fix aspect ratio<br>
<code><br>
theme(panel.background = element_rect(fill='black',colour='black'))+quiet+coord_equal()<br>
</code></p>
<p>We used ggave() to export from R and then we imported the pdf into Illustrator to produce the final graphic for print...</p>
<p><a href="http://spatial.ly/wp-content/uploads/2014/09/home_work_print.jpg"><img class="alignnone size-full wp-image-5121" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/home_work_print.jpg" alt="home_work_print" height="1257" width="2587"></a></p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-39848" class="post-39848 post type-post status-publish format-standard has-post-thumbnail hentry category-dataviz category-london category-r category-r-spatial category-rstats category-visualisation">
	
	<a class="post-thumbnail" href="http://spatial.ly/2014/11/r-visualisations-design/" aria-hidden="true">
		</a>

	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://blogs.casa.ucl.ac.uk/category/dataviz/" rel="category tag">dataviz</a>, <a href="http://blogs.casa.ucl.ac.uk/category/london/" rel="category tag">london</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r/" rel="category tag">R</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-spatial/" rel="category tag">R spatial</a>, <a href="http://blogs.casa.ucl.ac.uk/category/rstats/" rel="category tag">rstats</a>, <a href="http://blogs.casa.ucl.ac.uk/category/visualisation/" rel="category tag">visualisation</a></span>
		</div>
		<h1 class="entry-title"><a href="http://spatial.ly/2014/11/r-visualisations-design/" rel="bookmark">Improving R Data Visualisations Through Design</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://spatial.ly/2014/11/r-visualisations-design/" rel="bookmark"><time class="entry-date" datetime="2014-11-06T15:13:20+00:00">Thursday 6 November 2014</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://blogs.casa.ucl.ac.uk/author/james/" rel="author">James Cheshire</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>When I start an&nbsp;<a href="http://www.r-project.org/">R</a>&nbsp;class,
 one of my opening lines is nearly always that the software is now used 
by the likes of the New York Times graphics department or Facebook to 
manipulate their data and produce great visualisations. After saying 
this, however, I have always struggled to give tangible examples of how 
an R output blossoms into a stunning and informative graphic. That is 
until now…</p>
<p>I spent the past year working&nbsp;hard with an amazing designer&nbsp;– <a href="http://oliveruberti.com/">Oliver Uberti</a> – to create <a href="http://theinformationcapital.com/">a book</a> of 100+ maps and graphics about London. The majority of&nbsp;graphics we produced for&nbsp;<a href="http://theinformationcapital.com/">London: The Information Capital</a>&nbsp;required
 R code in some shape or form. This was used to do anything from 
simplifying millions of GPS tracks, to creating bubble charts or simply 
drawing a load of straight lines. We had to produce a graphic every 
three days to hit the publication deadline so without the efficiencies 
of copying and pasting old R code, or the flexibility to do almost any 
kind of plot, the book would not have been possible.&nbsp;&nbsp;So for 
those of you out there interested in the process of creating great 
graphics with R, here are 5 graphics shown from the moment they came out
 of R to the moment they were printed.</p>
<p><a href="http://spatial.ly/wp-content/uploads/2014/11/commute_flows_before_after.jpg"><img class="alignnone size-full wp-image-5159" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/commute_flows_before_after.jpg" alt="commute_flows_before_after" height="988" width="1029"></a><br>
This graphic shows the origin-destination flows of commuters in Southern England. In R I used the <code>geom_segment()</code> command from the brilliant&nbsp;<a href="http://ggplot2.org/">ggplot2</a>
 package to draw slightly transparent white lines between the centroids 
of the origins and destinations. I thought my R export looked pretty 
good on black, but we then imported it into Adobe Illustrator and Oliver
 applied a series of additional transparency effects to the lines to 
make them glow against the dark blue background (a colour we use 
throughout <a href="http://theinformationcapital.com/">the book</a>).<br>
<a href="http://spatial.ly/wp-content/uploads/2014/11/day_night_before_after.jpg"><img class="alignnone size-full wp-image-5161" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/day_night_before_after.jpg" alt="day_night_before_after" height="532" width="1029"></a><br>
This is a crop from a graphic we produced to show the differences 
between the daytime and nighttime population of London (we are showing 
nighttime here). It copies the code I used to produce my <a href="http://spatial.ly/2014/08/population-lines/">Population Lines </a>print,
 but Oliver went to the effort of manually cleaning the edges of the 
plot (I couldn’t work out how to automatically clip the lines in 
ggplot2!) by following the red-line I over-plotted. Colours were tweaked
 and labels added, all in Illustrator.<br>
<a href="http://spatial.ly/wp-content/uploads/2014/11/treasures_before_after.jpg"><img class="alignnone size-full wp-image-5162" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/treasures_before_after.jpg" alt="treasures_before_after" height="664" width="1029"></a><br>
One of my favourite graphics in <a href="http://theinformationcapital.com/">the book</a>&nbsp;shows the number if pieces of work by each artist in the <a href="http://www.tate.org.uk/">Tate</a>
 galleries.&nbsp;&nbsp;We can only show a small section here, but 
full-sized it looks spectacular as it features a Turner painting at its 
centre. The graphic started life as a treemap that simply scaled the 
squares by the number of artists. R has a very easy to use <code>treemap()</code> function in the <a href="http://cran.r-project.org/web/packages/treemap/index.html">treemap package</a>.
 Oliver then painstakingly broke the exported graphic to bits, converted
 the squares to picture frames and arranged them on “the wall”.<br>
<a href="http://spatial.ly/wp-content/uploads/2014/11/cycle_before_after.jpg"><img class="alignnone size-full wp-image-5163" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/cycle_before_after.jpg" alt="cycle_before_after" height="988" width="1029"></a><br>
This map, showing cyclists in London by time of day, was created from code similar to <a href="http://spatial.ly/2012/02/great-maps-ggplot2/">this graphic</a>.
 It is an example where very little needed to be done to plot once 
exported – we only really needed to add the River Thames (this could 
have been done in R), some labels and then optimise the colours for 
printing. Hundreds of thousands of line segments are plotted here and 
the graphic is an excellent illustration of R’s power to plot large 
volumes of data.<br>
<a href="http://spatial.ly/wp-content/uploads/2014/11/relationship_status_before_after.jpg"><img class="alignnone size-full wp-image-5164" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/relationship_status_before_after.jpg" alt="relationship_status_before_after" height="988" width="1029"></a><br>
The graphic above (<a href="http://theinformationcapital.com/project/relationship-status/">full size here</a>)
 has been the most popular from the book so far. It takes 2011 Census 
data and maps people by marital status as well as showing the absolute 
numbers as a streamgraph. ggplot2 was used to create both the maps and 
the plot. We stuck to the exported colours for the maps and then 
manually edited the streamgraph colours. The streamgraph was created 
with the <code>geom_ribbon()</code> function in ggplot2.<br>
<a href="http://spatial.ly/wp-content/uploads/2014/11/london_inspired_before_after.jpg"><img class="alignnone size-full wp-image-5165" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/london_inspired_before_after.jpg" alt="london_inspired_before_after" height="988" width="1029"></a></p>
<p>All the graphics shown so far started life as databases containing, as a minimum, several thousand rows of data. In <a href="http://theinformationcapital.com/project/who-london-inspired/">this final example</a> we show a “small data” example – the lives of 100 Londoners who have earned&nbsp;a <a href="https://www.english-heritage.org.uk/discover/blue-plaques/">blue plaque</a>
 on one of London’s buildings. The data were manually compiled with each
 person having 3 attributes against their name: the age they lived to, 
the age when they created their most significant work, the period of 
their life they lived in London.&nbsp;Thanks to ggplot2 I was able to 
use the code below to generate the coarse looking plot above. Oliver 
could then take this and flip it before restyling and adding labels in 
Illustrator. They key thing here was that a couple of lines of code in R
 saved a day of manually drawing lines.</p>
<p><code>#We order by age of when the person started living in London, this is the order field.</code></p>
<p><code>ggplot(Data,aes(order,origin))+geom_segment(aes(xend=order, 
yend=Age))+geom_segment(aes(x=order,y=st_age, xend=order, yend=end_age),
 col="red")+geom_segment(aes(x=order,y=st_age2, xend=order, 
yend=end_age2), col="yellow")+ coord_polar()</code></p>
<p>&nbsp;</p>
<p><a href="http://www.amazon.co.uk/gp/product/1846148472/ref=as_li_tl?ie=UTF8&amp;camp=1634&amp;creative=6738&amp;creativeASIN=1846148472&amp;linkCode=as2&amp;tag=spatialanalys-21">Purchase London: The Information Capital.</a></p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-19930" class="post-19930 post type-post status-publish format-standard has-post-thumbnail hentry category-featured-maps category-global-mapping category-r category-r-spatial category-rstats category-slideshow category-visualisation category-world-topography">
	
	<a class="post-thumbnail" href="http://spatial.ly/2014/02/stunning-maps-world-topography/" aria-hidden="true">
		</a>

	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://blogs.casa.ucl.ac.uk/category/featured-maps/" rel="category tag">Featured Maps</a>, <a href="http://blogs.casa.ucl.ac.uk/category/global-mapping/" rel="category tag">global mapping</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r/" rel="category tag">R</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-spatial/" rel="category tag">R spatial</a>, <a href="http://blogs.casa.ucl.ac.uk/category/rstats/" rel="category tag">rstats</a>, <a href="http://blogs.casa.ucl.ac.uk/category/slideshow/" rel="category tag">Slideshow</a>, <a href="http://blogs.casa.ucl.ac.uk/category/visualisation/" rel="category tag">visualisation</a>, <a href="http://blogs.casa.ucl.ac.uk/category/world-topography/" rel="category tag">world topography</a></span>
		</div>
		<h1 class="entry-title"><a href="http://spatial.ly/2014/02/stunning-maps-world-topography/" rel="bookmark">Stunning Maps of World Topography</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://spatial.ly/2014/02/stunning-maps-world-topography/" rel="bookmark"><time class="entry-date" datetime="2014-02-07T13:59:20+00:00">Friday 7 February 2014</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://blogs.casa.ucl.ac.uk/author/james/" rel="author">James Cheshire</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p><a href="http://topography.geotheory.co.uk/"><img class="alignnone size-full wp-image-5063" alt="world_bathy1" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/world_bathy1.jpg" height="1280" width="2560"></a></p>
<p><a href="http://geotheory.co.uk/">Robin Edwards,&nbsp;</a>a researcher at <a href="http://www.bartlett.ucl.ac.uk/casa">UCL CASA</a>,&nbsp;has created these <a href="http://topography.geotheory.co.uk/">stunning topographic map</a>s using the high resolution elevation data provided by the <a href="http://www.bodc.ac.uk/">British Oceanographic Data Centre</a>. The transitions from black (high areas) to blue (low areas) give the maps a slightly ethereal appearance to dramatic effect.</p>
<p><a href="http://topography.geotheory.co.uk/"><img class="alignnone size-full wp-image-5064" alt="europe" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/europe.jpg" height="1378" width="2560"></a>All
 but the highest areas of Europe appear to blend into the sea, and there
 is a loss in the sense of scale that makes the Pacific ranges look like
 small water channels in a shallow sea.</p>
<p><a href="http://topography.geotheory.co.uk/"><img class="alignnone size-full wp-image-5066" alt="pacific-ranges" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/pacific-ranges.jpg" height="1080" width="1900"></a></p>
<p>The best thing about these graphics (and the main reason I have 
featured them here) is that they were completely produced using the<a href="http://www.r-project.org/"> R software program</a>&nbsp;with just a 3 lines of code! <a href="http://geotheory.co.uk/blog/2014/02/07/visualising-topography/">Click here</a> to see how Robin did it.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-19376" class="post-19376 post type-post status-publish format-standard has-post-thumbnail hentry category-ggplot2 category-mapping category-r category-r-spatial category-r-spatial-tips category-resources category-rstats category-spatial category-spatial-analysis">
	
	<a class="post-thumbnail" href="http://spatial.ly/2013/12/introduction-spatial-data-ggplot2/" aria-hidden="true">
		</a>

	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://blogs.casa.ucl.ac.uk/category/ggplot2/" rel="category tag">ggplot2</a>, <a href="http://blogs.casa.ucl.ac.uk/category/mapping/" rel="category tag">mapping</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r/" rel="category tag">R</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-spatial/" rel="category tag">R spatial</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-spatial-tips/" rel="category tag">R Spatial Tips</a>, <a href="http://blogs.casa.ucl.ac.uk/category/resources/" rel="category tag">Resources</a>, <a href="http://blogs.casa.ucl.ac.uk/category/rstats/" rel="category tag">rstats</a>, <a href="http://blogs.casa.ucl.ac.uk/category/spatial/" rel="category tag">spatial</a>, <a href="http://blogs.casa.ucl.ac.uk/category/spatial-analysis/" rel="category tag">spatial analysis</a></span>
		</div>
		<h1 class="entry-title"><a href="http://spatial.ly/2013/12/introduction-spatial-data-ggplot2/" rel="bookmark">Introduction to Spatial Data and ggplot2</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://spatial.ly/2013/12/introduction-spatial-data-ggplot2/" rel="bookmark"><time class="entry-date" datetime="2013-12-09T12:12:30+00:00">Monday 9 December 2013</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://blogs.casa.ucl.ac.uk/author/james/" rel="author">James Cheshire</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p><a href="http://spatial.ly/wp-content/uploads/2013/12/spatial_ggplot2.png"><img class="alignnone size-full wp-image-5042" alt="spatial_ggplot2" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/spatial_ggplot2.png" height="504" width="504"></a></p>
<p>For those starting out with spatial data in R,<a href="http://robinlovelace.net/"> Robin Lovelace</a> and I have prepared this tutorial (funded as part of the University of Leeds and UCL <a href="http://www.geotalisman.org/">Talisman</a>
 project). Here we introduce a range of analysis skills before 
demonstrating how you can deploy the powerful graphics capabilities of 
ggplot2 to visualise your results. There is also some “bonus” material 
at the end to show how you can use ggplot2 for descriptive statistics 
and so on. The tutorial covers:</p>
<p>-Introduction to ggplot2</p>
<p>-Map projections</p>
<p>-Adding Google and <a href="http://stamen.com/">Stamen</a> basemaps</p>
<p>-Clipping and joining spatial data</p>
<p>-Aggregating spatial data</p>
<p>-ggplot2 for descriptive statistics</p>
<p>Download the data you need from <a href="http://spatial.ly/wp-content/uploads/2013/12/spatialggplot.zip">here</a>.</p>
<p>This is a work in progress so we may add improvements as time goes 
on. We also have a few more tutorials in the pipeline that will be 
posted here in due course.</p>
<p>&nbsp;</p>

<!-- iframe plugin v.2.7 wordpress.org/plugins/iframe/ -->
<iframe src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/intro-spatial.html" scrolling="no" class="iframe-class" frameborder="0" height="1500" width="100%"></iframe>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-18079" class="post-18079 post type-post status-publish format-standard has-post-thumbnail hentry category-cartogram category-map category-r category-r-cran category-r-spatial category-r-users category-resources category-rstats category-rstudio">
	
	<a class="post-thumbnail" href="http://spatial.ly/2013/06/r_activity/" aria-hidden="true">
		</a>

	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://blogs.casa.ucl.ac.uk/category/cartogram/" rel="category tag">cartogram</a>, <a href="http://blogs.casa.ucl.ac.uk/category/map/" rel="category tag">map</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r/" rel="category tag">R</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-cran/" rel="category tag">r cran</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-spatial/" rel="category tag">R spatial</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-users/" rel="category tag">r users</a>, <a href="http://blogs.casa.ucl.ac.uk/category/resources/" rel="category tag">Resources</a>, <a href="http://blogs.casa.ucl.ac.uk/category/rstats/" rel="category tag">rstats</a>, <a href="http://blogs.casa.ucl.ac.uk/category/rstudio/" rel="category tag">rstudio</a></span>
		</div>
		<h1 class="entry-title"><a href="http://spatial.ly/2013/06/r_activity/" rel="bookmark">Where is the R Activity?</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://spatial.ly/2013/06/r_activity/" rel="bookmark"><time class="entry-date" datetime="2013-06-10T19:35:58+00:00">Monday 10 June 2013</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://blogs.casa.ucl.ac.uk/author/james/" rel="author">James Cheshire</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p><a href="http://spatial.ly/wp-content/uploads/2013/06/r_activity.png"><img class="alignnone size-full wp-image-4697" alt="r_activity" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/r_activity.png" height="905" width="1633"></a></p>
<p><a href="http://www.r-project.org/">R</a>&nbsp;has become one of the 
world’s most widely used statistics and visualisation software packages 
with an ever growing user community.&nbsp;Thanks to the <a href="http://cran-logs.rstudio.com/">release of&nbsp;log</a> files containing all hits to&nbsp;<a href="http://cran.rstudio.com/">http://cran.rstudio.com/</a>&nbsp;server
 it is possible to make a map showing the parts of the world with the 
most active R users (specifically those mostly using the <a href="http://www.rstudio.com/">RStudio</a>
 interface). The USA comes top with 3,045,960 requests to the server 
between October 2012 and June 2013. Japan is in 2nd place with a mere 
756,177 requests and Germany 3rd. In all 203 countries appear in the 
server logs. I have scaled the map according to the number of server 
requests made and you can clearly see the dominance of Japan, Europe and
 North America compared with other parts of the world, especially 
Africa. The map of course isn’t a perfect representation of the number 
of R users, as you could have one or two people making hundreds of 
server requests a day versus a large number of people only making a 
couple. This is why I have entitled the map “Activity” rather than 
“Users”. &nbsp;Either way R hasn’t quite achieved global domination but 
it is getting there…</p>
<p>To create the map I obtained the files following the instructions on the logs&nbsp;<a href="http://cran-logs.rstudio.com/">download page</a>. I then combined them with the following code (<a href="http://psychwire.wordpress.com/2011/06/03/merge-all-files-in-a-directory-using-r-into-a-single-dataframe/">take from here</a>):<br>
<code>setwd("XXX") #this needs to be the directory with the downloaded files in it.<br>
file_list &lt;- list.files()</code></p><code>
<p>for (file in file_list){</p>
<p>  # if the merged dataset doesn't exist, create it<br>
  if (!exists("dataset")){<br>
    dataset &lt;- read.csv(file, header=TRUE)<br>
  }</p>
</code><p><code>  # if the merged dataset does exist, append to it<br>
  if (exists("dataset")){<br>
    temp_dataset &lt;- read.csv(file, header=TRUE)<br>
    dataset&lt;-rbind(dataset, temp_dataset)<br>
    rm(temp_dataset)<br>
  }<br>
 print(file)<br>
}<br>
</code><br>
It is then possible to aggregate the data to get the number of requests per country.<br>
<code><br>
dataset$flag&lt;- 1<br>
counts&lt;- aggregate(dataset$flag, by=list(dataset$country), sum)<br>
names(counts)&lt;- c("country", "count")<br>
</code><br>
The next step was to <a href="http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/110m/cultural/ne_110m_admin_0_countries.zip">download a world shapefile</a>
 (containing the country borders) from Natural Earth. This contains the 
country codes used in the log file (the dataset object above). We can 
open this file with the maptools package:<br>
<code><br>
library(maptools)<br>
world&lt;-readShapePoly("yourworldshapefile")<br>
</code><br>
It is then possible to join our counts object to the world object to 
assign the log counts to each country based on the "iso_a2" and 
"country" fields respectively. The new shapefile is also saved.<br>
<code><br>
world@data = data.frame(world@data, counts[match(world@data[,"iso_a2"], counts[,"country"]),])<br>
writePolyShape(world, "world_r_use.shp")<br>
</code><br>
This next bit is a bit of a cheat as I used the <a href="http://scapetoad.choros.ch/">ScapeToad</a> software to create the cartogram. A <a href="http://stackoverflow.com/questions/9319597/cartogram-choropleth-map-in-r">package exists</a> to do this in R but I find ScapeToad to be more powerful. You can download the shapefile I produced from <a href="http://spatial.ly/wp-content/uploads/2013/06/r_cartogram.zip">here</a>. I have then reloaded the new shapefile into R and used the basic plot functions to produce the map.<br>
<code></code></p><code>
<p>cartogram&lt;-readShapePoly("world_r_carto.shp")</p>
<p>plot(cartogram)<br>
title(main="R Activity Around the World", sub="Based on cran.rstudio.com Activity Logs October 2012-June 2013")</p>
</code><p><code></code></p>
<p>This is my first stab at looking at the data - there is a lot more that can be done with it!</p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-17969" class="post-17969 post type-post status-publish format-standard has-post-thumbnail hentry category-3d category-mapping category-r category-r-spatial category-resources">
	
	<a class="post-thumbnail" href="http://spatial.ly/2013/05/3d-mapping-r/" aria-hidden="true">
		</a>

	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://blogs.casa.ucl.ac.uk/category/3d/" rel="category tag">3D</a>, <a href="http://blogs.casa.ucl.ac.uk/category/mapping/" rel="category tag">mapping</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r/" rel="category tag">R</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-spatial/" rel="category tag">R spatial</a>, <a href="http://blogs.casa.ucl.ac.uk/category/resources/" rel="category tag">Resources</a></span>
		</div>
		<h1 class="entry-title"><a href="http://spatial.ly/2013/05/3d-mapping-r/" rel="bookmark">3D Mapping in R</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://spatial.ly/2013/05/3d-mapping-r/" rel="bookmark"><time class="entry-date" datetime="2013-05-08T14:33:34+00:00">Wednesday 8 May 2013</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://blogs.casa.ucl.ac.uk/author/james/" rel="author">James Cheshire</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<section>
<section>
<section>This tutorial has been kindly&nbsp;contributed&nbsp;by<a href="http://geotheory.co.uk/">&nbsp;Robin Edwards&nbsp;</a>(from UCL CASA).</section>
</section>
</section>
<div>
<p><a style="font-size: 13px;" href="http://cran.r-project.org/web/packages/rgl/rgl.pdf">RGL</a><span style="font-size: 13px;">&nbsp;is
 R’s box of power-tool for 3D object rendering, with functionality for 
creating 3d mesh objects and curved surfaces, and for using materials 
and directional lighting. &nbsp;For example the line:</span></p>
<pre>plot3d(rnorm(100),rnorm(100),rnorm(100))</pre>
<p>creates a 3d scatterplot of x-y-z normal distributions, producing:</p>
<p><a href="http://spatial.ly/wp-content/uploads/2013/05/rgl_basic_example.png"><img class="alignnone size-full wp-image-4488" alt="rgl_basic_example" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/rgl_basic_example.png" height="562" width="606"></a></p>
<p><a href="http://www.r-bloggers.com/the-openstreetmap-package-opens-up/">OpenStreetMap</a>&nbsp;provides a nice way to import map tiles via the OSM API (among others). A helpful StackOverLoader (<a href="http://stackoverflow.com/questions/16202558/plotting-3d-maps-with-rgl/16232865#16232865">Spacedman</a>) has provided this useful function for adding ‘z’ values to OSM map objects, enabling them to be plotted in 3d:</p>
<pre>map3d &lt;- function(map, ...){
  if(length(map$tiles)!=1){stop("multiple tiles not implemented") }
  nx = map$tiles[[1]]$xres
  ny = map$tiles[[1]]$yres
  xmin = map$tiles[[1]]$bbox$p1[1]
  xmax = map$tiles[[1]]$bbox$p2[1]
  ymin = map$tiles[[1]]$bbox$p1[2]
  ymax = map$tiles[[1]]$bbox$p2[2]
  xc = seq(xmin,xmax,len=ny)
  yc = seq(ymin,ymax,len=nx)
  colours = matrix(map$tiles[[1]]$colorData,ny,nx)
  m = matrix(0,ny,nx)
  surface3d(xc,yc,m,col=colours, ...)
}</pre>
<p>A benefit of the approach is that it enables you to adjust the map to
 the ideal perspective for representing the data in the final rendered 
image. Here I’ve applied the function to&nbsp;<a href="http://data.london.gov.uk/datastore/package/average-private-rents-borough">data on London’s rental costs</a>&nbsp;(for the year to December 2012), extruding thick lines for cost comparisons:</p>
<p><a href="http://spatial.ly/wp-content/uploads/2013/05/rgl_3d_map.jpg"><img class="alignnone size-full wp-image-4486" alt="rgl_3d_map" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/rgl_3d_map.jpg" height="847" width="1919"></a></p>
<p>The satellite version, simply replacing ‘osm’ with ‘bing’ in the code..<br>
<a href="http://spatial.ly/wp-content/uploads/2013/05/rgl_3d_satellite.jpg"><img class="alignnone size-full wp-image-4487" alt="rgl_3d_satellite" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/rgl_3d_satellite.jpg" height="603" width="1849"></a></p>
<p><a href="https://gist.github.com/geotheory/5469317">Code @ Github</a></p>
</div>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-17954" class="post-17954 post type-post status-publish format-standard hentry category-beginners category-crash-course category-r category-r-spatial category-resources">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://blogs.casa.ucl.ac.uk/category/beginners/" rel="category tag">beginners</a>, <a href="http://blogs.casa.ucl.ac.uk/category/crash-course/" rel="category tag">crash course</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r/" rel="category tag">R</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-spatial/" rel="category tag">R spatial</a>, <a href="http://blogs.casa.ucl.ac.uk/category/resources/" rel="category tag">Resources</a></span>
		</div>
		<h1 class="entry-title"><a href="http://spatial.ly/2013/05/crash/" rel="bookmark">A Crash Course in R</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://spatial.ly/2013/05/crash/" rel="bookmark"><time class="entry-date" datetime="2013-05-01T17:34:24+00:00">Wednesday 1 May 2013</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://blogs.casa.ucl.ac.uk/author/james/" rel="author">James Cheshire</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>This code has been kindly&nbsp;contributed&nbsp;by<a href="http://geotheory.co.uk/"> Robin Edwards </a>(from UCL CASA).</p>
<p>There are many useful introductory guides out there to R, but below 
is the kind of thing I now wish I’d been given when I first started 
using it – something with simple logically-progressive examples and 
minimal explanatory text. Copy the text below into a new script in R and
 run line-by-line to give a quick intro to many of R’s most basic 
principles and functionality. You can also download a text file with it <a href="http://spatial.ly/wp-content/uploads/2013/05/r_crash_course.txt">here</a>.
 It is by no means comprehensive, even at the most basic level, but 
still I hope someone finds it useful. You may want to look at <a href="http://www.rstudio.com/">RStudio</a>&nbsp;as it is more user-friendly.<br>
<code><br>
## A CRASH COURSE IN [R] PROGRAMMING<br>
## Robin Edwards (geotheory.co.uk), March 2013<br>
## In RStudio run through line-by-line using Ctrl + Enter</code></p>
<p># basic R environmental functions<br>
x=3.14159; y=’hello world’; z=TRUE # create some objects. In RStudio they’ll appear in ‘Workspace’<br>
ls() # list the objects in the Workspace<br>
print(y) # print information to R ‘Console’<br>
rm(y) # remove an object<br>
rm(list=ls()) # remove all<br>
getwd() # find current working directory<br>
setwd(“/Users/robinedwards/Documents”) # set working directory as preferred<br>
print ( “R ignores the ‘white-space’ in command syntax” )</p>
<p># use ‘?’ for help on any R function (if its library is loaded in the session)<br>
?max<br>
??csv # search for a text string in R documentation library<br>
library(help=utils) # get help on a particular package (list its functions)</p>
<p># ‘str’ is a powerful tool for investigating the underlying structure of any R object<br>
str(max)</p>
<p># CREATING AND MANIPULATING R OBJECTS</p>
<p># assigning values to variables<br>
n = 5 # is possible but<br>
n 5 -&gt; n<br>
rm(n)</p>
<p># R objects can be of various data types, but probably most common are ‘numeric’ and ‘character’<br>
( num ( char &lt;- ‘any text string’ )</p>
<p># create a VECTOR (array) using the ‘c()’ concatenate function<br>
( vec</p>
<p># a vector series<br>
( vec</p>
<p># R vectors can be accessed in various ways using [ ] brackets<br>
vec[3]<br>
vec[3:6]<br>
vec[ c(1,3,8) ]<br>
vec[vec &gt; 15]</p>
<p># check a vector contains a value<br>
5 %in% vec<br>
12 %in% vec</p>
<p># finding first index position of a matching value/sting<br>
( x = c(‘one’, ‘five’, ‘two’, 3, ‘two’) )<br>
match(‘two’, x)<br>
match(c(‘two’,'five’), x)</p>
<p># a MATRIX is a 2D vector (essentially a vector of vectors) of matching data type<br>
( matrx = matrix(1:15, 3, 5) )<br>
( matrx dim(matrx) print(matrx)<br>
t(matrx) # a matrix can be easily transposed</p>
<p># an ARRAY is a generic vector but with more flexibiity. A 1D array is the same as a normal vector,<br>
# and a 2D array is like a matrix. But arrays can store data with ‘n’ dimensions:<br>
( arry</p>
<p># Using square brackets on arrays<br>
arry[12] # a single criterion (argument) selects the array’s n’th record<br>
arry[3,1,2] # or use multiple arguments that reflect the array’s dimensionality<br>
arry[,,2]<br>
arry[,1,]</p>
<p># a DATA.FRAME is like a matrix, but accomodates fields (columns) with different data types<br>
(df</p>
<p># They can be viewed easily<br>
View(df)</p>
<p># examine their internal stucture<br>
str(df)</p>
<p># data interrogation with square brackets<br>
df[1,]<br>
df[2:3,]<br>
df[,1]<br>
df[2,1]</p>
<p># data.frame and matrix objects can have field (column) and record (row) names<br>
dimnames(df)<br>
colnames(df)<br>
names(df) # not for matrix objects<br>
row.names(df)</p>
<p># interrogate data.frames by field name using the ‘$’ operator. the result is a simple vector<br>
df$name<br>
df$name[2]</p>
<p># names can be reassigned<br>
names(df) row.names(df) print(df)</p>
<p># check dimensions of vector/matrix/array/data.frame objects<br>
length(vec)<br>
dim(df)<br>
dim(arry)<br>
nrow(df)<br>
ncol(df)</p>
<p># R has various inbuilt data.frame datasets used to illustrate how functions operate e.g.<br>
data()<br>
InsectSprays # this guide makes use of these datasets<br>
warpbreaks</p>
<p># examine contents<br>
head(InsectSprays) # list the top records of a vector / matrix / d.f.<br>
tail(InsectSprays, n=3) # bottom the 3<br>
summary(InsectSprays) # summarise a data vector</p>
<p># aggregate() is a powerful function for summarising categorical data<br>
aggregate(InsectSprays$count, by=list(InsectSprays$spray), FUN=mean)<br>
sumInsects names(sumInsects) print(sumInsects)</p>
<p># subset/apply filter to a data.frame<br>
warpbreaks[warpbreaks$wool=='A',] # by 1 condition<br>
warpbreaks[warpbreaks$tension %in% c('L','M'),] # multiple conditions</p>
<p># adding entries is possible (if a bit tricky)<br>
(newrow (warpbreaks</p>
<p># but LISTS are better at this<br>
lst = list()</p>
<p># ways to assign/add items<br>
lst[1] = “one”<br>
lst[[2]] &lt;- “two”<br>
lst[length(lst)+1] &lt;- “three”<br>
print(lst)</p>
<p># data retrieval<br>
lst[[1]] # double brackets means the object returned is of the data class of the list item<br>
lst[2:3] # selecting a more than 1 list item is possible with single brackets..<br>
lst[c(1,3)] # but the object returned (from single bracket interrogation) is a list</p>
<p># delete list items<br>
lst[[3]] lst[1:2] lst</p>
<p># entries can be any object type (like python), including other lists (double bracketting)<br>
lst[[1]] lst[[2]] &lt;- ‘item2′<br>
lst<br>
lst[[1]][[1]]</p>
<p># Data in lists can also be stored and recalled by key word/number (like Python’s dictionary class)<br>
dict dict['wed'] print(dict)<br>
dict[['tues']]<br>
dict[c('mon','wed')]</p>
<p># reorder a vector with ‘sort’<br>
vec sort(vec)</p>
<p># or a dataframe with ‘order’<br>
df[order(df$years),]</p>
<p># LOGICAL objects (booleans) are binary true/false objects that facilitate conditional data processing<br>
(bool (bool</p>
<p># query an object’s data/structure type with ‘class()’<br>
class(bool)<br>
class(num) # numeric is the default data type for number objects<br>
class(as.integer(num)) # integer class exists but is not default<br>
class(char) # character class<br>
class(’237′ ) # numbers aren’t always numeric type<br>
as.numeric(’237′) # but can be converted<br>
as.character(237) # and vice verse</p>
<p># Child-objects are often of different class to parents<br>
class(df)<br>
class(df[,2])<br>
class(df[,1])</p>
<p># FACTOR objects are vectors of items that have been categorised by unique values<br>
factr str(factr)<br>
levels(factr)<br>
table(factr)</p>
<p># you may encounter problems converting a factor of numeric data to numeric type<br>
as.numeric(factr)</p>
<p># instead do this<br>
as.numeric(as.character(factr))</p>
<p># editing factors can be tricky<br>
print(df)<br>
df$person[1] &lt;- ‘Matthew’</p>
<p># instead convert to character or numeric etc<br>
df$person df$person[1] &lt;- ‘Matthew’<br>
df$person levels(df$person)</p>
<p># LOGICAL OPERATIONS<br>
2 + 2 == 4 # ‘==’ denotes value equality<br>
3 &lt;= 2 # less than or equal to<br>
3 &gt;= 2 # greater than or equal to<br>
‘string’ == “string”<br>
‘b’ &gt;= ‘a’ # strings can be ranked<br>
3 != 3 # NOT operator<br>
c(4,2,6) == c(4,2,8) # vector comparisons return locical vectors<br>
TRUE == T # ‘T’ and ‘F’ default as boolean shortcuts (until overwritten)<br>
TRUE &amp; TRUE # AND operator<br>
TRUE | FALSE # OR operator<br>
F | F</p>
<p># IF/ELSE statement (used in most logical procedures)<br>
x if(x &lt; 5){<br>
print(‘x is less than 5′)<br>
} else{<br>
print(‘x is not less than 5′)<br>
}</p>
<p>if(T|F) print(‘single liners can dispense with curly brackets’)<br>
if(T&amp;F) print(”) else print(“but then ‘else’ only works on the same line”)</p>
<p># LOOPING FUNCTIONS – very useful for handling repetitive operations</p>
<p># ‘FOR’ loop<br>
for(i in 1:10){<br>
print(paste(‘number ‘,i))<br>
}</p>
<p># WHILE loop (be careful to include safeguards to prevent infinite loops)<br>
i = 30<br>
while(i &gt; 0){<br>
print(paste(‘number ‘,i))<br>
i = i – 3<br>
}</p>
<p># creating a function<br>
multiply tot return(tot)<br>
}</p>
<p>multiply(3,5)<br>
# note ‘tot’ wasn’t remembered outside the function – functions are contained environments<br>
# if required use ‘&lt;&lt;-’ for global assignment but be careful not to overwrite R’s internal objects<br>
# its generally better to do this:<br>
newVar</p>
<p># handling ‘NA’ values<br>
(x = 1:5)<br>
x[8] = 8<br>
x[3] = NA<br>
print(x) # sometimes functions will fail because of NA values<br>
na.omit(x) # iterates full list but ignores NAs<br>
x[na.omit(x)]<br>
is.na(x) # alternatively<br>
x[!is.na(x)]</p>
<p># useful basic math functions<br>
seq(-2, 2, by=.2) # sequence of equal difference<br>
seq(length=10, from=-5, by=.2) # with range defined by vector length<br>
rnorm(20, mean = 0, sd = 1) # random normal distribution<br>
runif(20, min=0, max=100) # array of random numbers<br>
sample(0:100, 20, replace=TRUE) # array of random integers<br>
table(warpbreaks[,2:3]) # array summary stats (powerful summary tool)<br>
min(vec)<br>
max(vec)<br>
range(vec)<br>
mean(vec)<br>
median(vec)<br>
sum(vec)<br>
prod(vec)<br>
abs(-5) # magnitude<br>
sd(rnorm(10)) # standard deviation<br>
4^2 # square<br>
sqrt(16) # square root<br>
5%%3 # modulo (remainder after subtraction of any multiple)<br>
6%%2<br>
for(i in 1:100) if(i%%20==0) print(i) # useful for running an operation every n’th cycle</p>
<p># Importing and exporting data using comma-separated file<br>
write.csv(df, ‘example.csv’) # save to csv file<br>
rm(df)<br>
(df</p>
<p># PLOTTING IN R</p>
<p># some basic functionality<br>
plot(1:10)<br>
plot(sort(rnorm(100)), pch=16, cex=0.5) # specifying point and size respectively<br>
plot(x=1:25, y=25:1, pch=1:25) # x &amp; y inputs, and showing the available point symbols<br>
plot(sin, -pi, 2*pi)<br>
hist(rnorm(1000), breaks=50)<br>
barplot(sumInsects$sum, names.arg = sumInsects$group)<br>
pie(sumInsects$sum, labels = sumInsects$group)</p>
<p># plots with more visual components are built up incrementally<br>
x plot(x, pch=17)<br>
lines(x, col=’#00FF00′)<br>
points(x+5, pch=16, col=’red’)</p>
<p># stacking charts<br>
warpbreaks<br>
sumWB names(sumWB) sumWB<br>
(data barplot(data, names.arg=c(‘Group A’,'Group B’),<br>
legend.text=c(‘L’,'M’,'H’), args.legend = list(x = “right”))</p>
<p>barplot(data, names.arg=c(‘Group A’,'Group B’), beside=T,<br>
legend.text=c(‘L’,'M’,'H’), args.legend = list(x = “topright”))</p>
<p># ‘symbols()’ is a good way to represent a 3rd data dimension (use square root for area proportionality)<br>
(cities lon=c(-0.1,-2.6,-2.2,-1.5), lat=c(51.5,51.4,53.5,53.8), pop=c(8,1,2.7,0.8)))<br>
symbols(x=cities$lon, y=cities$lat, circles=sqrt(cities$pop), inches=0.3,<br>
bg=’red’, fg=NULL, asp=T, xlab=’Longitude’, ylab=’Latitude’)<br>
abline(h=(seq(51,53,1)), col=”lightgray”, lty=1)<br>
abline(v=(seq(-4,1,1)), col=”lightgray”, lty=1)<br>
text(x=cities$lon, y=cities$lat+0.2, labels=cities$city)</p>
<p># But for much easier and more elegant data visualisation use GGPLOT2</p>
<p># END OF SCRIPT</p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-301" class="post-301 post type-post status-publish format-standard has-post-thumbnail hentry category-britain category-featured-maps category-london category-london-datastore category-map category-opendata category-population category-r category-r-maps category-r-spatial category-r-spatial-tips category-rcolorbrewer category-rspatialtips category-rstats category-visualisation">
	
	<a class="post-thumbnail" href="http://spatialanalysis.co.uk/2011/02/mapping-londons-population-change-2011-2030/" aria-hidden="true">
		</a>

	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://blogs.casa.ucl.ac.uk/category/britain/" rel="category tag">Britain</a>, <a href="http://blogs.casa.ucl.ac.uk/category/featured-maps/" rel="category tag">Featured Maps</a>, <a href="http://blogs.casa.ucl.ac.uk/category/london/" rel="category tag">london</a>, <a href="http://blogs.casa.ucl.ac.uk/category/london-datastore/" rel="category tag">london datastore</a>, <a href="http://blogs.casa.ucl.ac.uk/category/map/" rel="category tag">map</a>, <a href="http://blogs.casa.ucl.ac.uk/category/opendata/" rel="category tag">opendata</a>, <a href="http://blogs.casa.ucl.ac.uk/category/population/" rel="category tag">population</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r/" rel="category tag">R</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-maps/" rel="category tag">R Maps</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-spatial/" rel="category tag">R spatial</a>, <a href="http://blogs.casa.ucl.ac.uk/category/r-spatial-tips/" rel="category tag">R Spatial Tips</a>, <a href="http://blogs.casa.ucl.ac.uk/category/rcolorbrewer/" rel="category tag">RColorBrewer</a>, <a href="http://blogs.casa.ucl.ac.uk/category/rspatialtips/" rel="category tag">rspatialtips</a>, <a href="http://blogs.casa.ucl.ac.uk/category/rstats/" rel="category tag">rstats</a>, <a href="http://blogs.casa.ucl.ac.uk/category/visualisation/" rel="category tag">visualisation</a></span>
		</div>
		<h1 class="entry-title"><a href="http://spatialanalysis.co.uk/2011/02/mapping-londons-population-change-2011-2030/" rel="bookmark">Mapping London’s Population Change 1801-2030</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://spatialanalysis.co.uk/2011/02/mapping-londons-population-change-2011-2030/" rel="bookmark"><time class="entry-date" datetime="2011-02-16T10:34:20+00:00">Wednesday 16 February 2011</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://blogs.casa.ucl.ac.uk/author/james/" rel="author">James Cheshire</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p style="text-align: center;"><a href="http://spatialanalysis.co.uk/wp-content/uploads/2011/02/london_pop_change1.png"><img class="aligncenter size-full wp-image-2205" title="london_pop_change" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/london_pop_change1.png" alt="" height="412" width="601"></a></p>
<p style="text-align: left;">Buried&nbsp;in the <a href="http://data.london.gov.uk/">London Datastore</a> are the <a href="http://data.london.gov.uk/datastore/package/gla-population-projections-2009-round-revised-shlaa-borough-sya">population estimates</a> for each of the <a href="http://en.wikipedia.org/wiki/London_borough">London Boroughs</a>
 between 2001 – 2030. They predict a declining population for most 
boroughs with the exception of a few to the east. I was surprised by 
this general decline and also the numbers involved- I expected larger 
changes from one year to the next. I think this is because my perception
 of migration is of the volume of people moving rather than the net 
effects on the baseline population of these movements. I don’t envy the <a href="http://www.london.gov.uk/">GLA</a> for making <a href="http://data.london.gov.uk/datastore/package/gla-population-projections-2009-round-revised-shlaa-borough-sya">predictions</a> so far into the future, but can understand why they have to do it (think how long it took initiate <a href="http://en.wikipedia.org/wiki/Crossrail">Crossrail</a>!). Last year I produced a simple animation showing past changes in London’s population density (<a href="http://data.london.gov.uk/datastore/package/historic-census-population">data</a>)&nbsp;and it provides a nice&nbsp;comparison&nbsp;to the above. In total I have squeezed 40 maps on this page!</p>
<p style="text-align: left;"><a href="http://spatialanalysis.co.uk/wp-content/uploads/2010/01/london_pop_density.gif"><img class="aligncenter size-full wp-image-534" title="london_pop_density" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/london_pop_density.gif" alt="" height="400" width="600"></a></p>
<h3>Technical Stuff</h3>
<p>These maps were all produced to demonstrate the mapping&nbsp;capabilities&nbsp;of&nbsp;<a href="http://www.r-project.org/">R</a>. The first uses <a href="http://had.co.nz/ggplot2/">ggplot2</a> (plus <a href="http://cran.r-project.org/web/packages/classInt/index.html">classInt</a> + <a href="http://cran.r-project.org/web/packages/RColorBrewer/index.html">RColorBrewer</a>)&nbsp;and is based on some <a href="https://bitbucket.org/markbulling/open-source/src/ded7d7392a5c/London%20Immigration.R">code</a> (see below) written by <a href="http://dotlinking.blogspot.com/">Mark Bulling</a>. If you follow the code below you will end up with<a href="http://www.flickr.com/photos/everheardofaspacebar/4259967972/in/photostream/"> this map</a>,
 not the one I have produced above. I will stick my code in a formal 
tutorial soon. The animation uses the standard plot functions (plus 
spatial packages) in R as per this <a href="http://rspatialtips.org.uk/2011/01/19/r-maps/">example</a>.<br>
<script type="text/javascript" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/London%2520Immigration.js"></script><link rel="stylesheet" href="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/embed.css"></p><div class="bb-source-embed"><div class="bb-source-embed--code-wrapper"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><a href="#London%20Immigration.R-1"> 1</a>
<a href="#London%20Immigration.R-2"> 2</a>
<a href="#London%20Immigration.R-3"> 3</a>
<a href="#London%20Immigration.R-4"> 4</a>
<a href="#London%20Immigration.R-5"> 5</a>
<a href="#London%20Immigration.R-6"> 6</a>
<a href="#London%20Immigration.R-7"> 7</a>
<a href="#London%20Immigration.R-8"> 8</a>
<a href="#London%20Immigration.R-9"> 9</a>
<a href="#London%20Immigration.R-10">10</a>
<a href="#London%20Immigration.R-11">11</a>
<a href="#London%20Immigration.R-12">12</a>
<a href="#London%20Immigration.R-13">13</a>
<a href="#London%20Immigration.R-14">14</a>
<a href="#London%20Immigration.R-15">15</a>
<a href="#London%20Immigration.R-16">16</a>
<a href="#London%20Immigration.R-17">17</a>
<a href="#London%20Immigration.R-18">18</a>
<a href="#London%20Immigration.R-19">19</a>
<a href="#London%20Immigration.R-20">20</a>
<a href="#London%20Immigration.R-21">21</a>
<a href="#London%20Immigration.R-22">22</a>
<a href="#London%20Immigration.R-23">23</a>
<a href="#London%20Immigration.R-24">24</a>
<a href="#London%20Immigration.R-25">25</a>
<a href="#London%20Immigration.R-26">26</a>
<a href="#London%20Immigration.R-27">27</a>
<a href="#London%20Immigration.R-28">28</a>
<a href="#London%20Immigration.R-29">29</a>
<a href="#London%20Immigration.R-30">30</a>
<a href="#London%20Immigration.R-31">31</a>
<a href="#London%20Immigration.R-32">32</a>
<a href="#London%20Immigration.R-33">33</a>
<a href="#London%20Immigration.R-34">34</a>
<a href="#London%20Immigration.R-35">35</a>
<a href="#London%20Immigration.R-36">36</a>
<a href="#London%20Immigration.R-37">37</a>
<a href="#London%20Immigration.R-38">38</a>
<a href="#London%20Immigration.R-39">39</a>
<a href="#London%20Immigration.R-40">40</a>
<a href="#London%20Immigration.R-41">41</a>
<a href="#London%20Immigration.R-42">42</a>
<a href="#London%20Immigration.R-43">43</a>
<a href="#London%20Immigration.R-44">44</a>
<a href="#London%20Immigration.R-45">45</a>
<a href="#London%20Immigration.R-46">46</a>
<a href="#London%20Immigration.R-47">47</a>
<a href="#London%20Immigration.R-48">48</a>
<a href="#London%20Immigration.R-49">49</a>
<a href="#London%20Immigration.R-50">50</a>
<a href="#London%20Immigration.R-51">51</a>
<a href="#London%20Immigration.R-52">52</a>
<a href="#London%20Immigration.R-53">53</a>
<a href="#London%20Immigration.R-54">54</a>
<a href="#London%20Immigration.R-55">55</a>
<a href="#London%20Immigration.R-56">56</a>
<a href="#London%20Immigration.R-57">57</a>
<a href="#London%20Immigration.R-58">58</a>
<a href="#London%20Immigration.R-59">59</a>
<a href="#London%20Immigration.R-60">60</a>
<a href="#London%20Immigration.R-61">61</a>
<a href="#London%20Immigration.R-62">62</a>
<a href="#London%20Immigration.R-63">63</a>
<a href="#London%20Immigration.R-64">64</a>
<a href="#London%20Immigration.R-65">65</a></pre></div></td><td class="code"><div class="highlight"><pre><a name="London Immigration.R-1"></a><span class="c1">##################################################</span>
<a name="London Immigration.R-2"></a><span class="c1">## London Data Maps Visualisation               ##</span>
<a name="London Immigration.R-3"></a><span class="c1">## Author: Mark Bulling                         ##</span>
<a name="London Immigration.R-4"></a><span class="c1">## Date: 2011-06-01                             ##</span>
<a name="London Immigration.R-5"></a><span class="c1">## Comments: code to generate maps of London    ##</span>
<a name="London Immigration.R-6"></a><span class="c1">##################################################</span>
<a name="London Immigration.R-7"></a>
<a name="London Immigration.R-8"></a><span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<a name="London Immigration.R-9"></a><span class="kn">library</span><span class="p">(</span>maps<span class="p">)</span>
<a name="London Immigration.R-10"></a><span class="kn">library</span><span class="p">(</span>sp<span class="p">)</span>
<a name="London Immigration.R-11"></a>
<a name="London Immigration.R-12"></a>gpclibPermit<span class="p">()</span>
<a name="London Immigration.R-13"></a>
<a name="London Immigration.R-14"></a><span class="c1">#### Read in shapefiles for UK LA's from GADM</span>
<a name="London Immigration.R-15"></a>con <span class="o">&lt;-</span> <span class="kp">url</span><span class="p">(</span><span class="s">"http://www.gadm.org/data/rda/GBR_adm2.RData"</span><span class="p">)</span>
<a name="London Immigration.R-16"></a><span class="kp">print</span><span class="p">(</span><span class="kp">load</span><span class="p">(</span>con<span class="p">))</span>
<a name="London Immigration.R-17"></a><span class="kp">close</span><span class="p">(</span>con<span class="p">)</span>
<a name="London Immigration.R-18"></a>
<a name="London Immigration.R-19"></a><span class="c1">#### Fortify this using ggplot2 features - this turns the shapefiles into a dataframe</span>
<a name="London Immigration.R-20"></a>ukmap <span class="o">&lt;-</span> fortify.SpatialPolygonsDataFrame<span class="p">(</span>gadm<span class="p">,</span> region<span class="o">=</span><span class="s">"NAME_2"</span><span class="p">)</span>
<a name="London Immigration.R-21"></a>ukmap<span class="o">$</span>order <span class="o">&lt;-</span> <span class="kp">rownames</span><span class="p">(</span>ukmap<span class="p">)</span> <span class="c1">### Order is important when drawing the map</span>
<a name="London Immigration.R-22"></a>
<a name="London Immigration.R-23"></a><span class="c1">#### Read in the immigration data from London datastore</span>
<a name="London Immigration.R-24"></a>url <span class="o">&lt;-</span> <span class="s">"http://data.london.gov.uk/datafiles/demographics/nino-registrations-overseas-borough-2009.csv"</span>
<a name="London Immigration.R-25"></a>
<a name="London Immigration.R-26"></a>london.data <span class="o">&lt;-</span> read.csv<span class="p">(</span><span class="kp">url</span><span class="p">)</span>
<a name="London Immigration.R-27"></a>
<a name="London Immigration.R-28"></a><span class="c1">### Melt the data to turn it into something that can be cast</span>
<a name="London Immigration.R-29"></a>london.data.melt <span class="o">&lt;-</span> melt<span class="p">(</span>x<span class="p">,</span> id<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">"Code"</span><span class="p">,</span> <span class="s">"Area"</span><span class="p">,</span> <span class="s">"Total.Number.of.Registrations"</span><span class="p">,</span> <span class="s">"MYE.Working.age.2008"</span><span class="p">))</span>
<a name="London Immigration.R-30"></a>london.data.cast <span class="o">&lt;-</span> cast<span class="p">(</span>london.data.melt<span class="p">,</span> variable<span class="o">~</span><span class="m">.</span><span class="p">,</span> fun.aggregate<span class="o">=</span><span class="kp">sum</span><span class="p">)</span>
<a name="London Immigration.R-31"></a><span class="kp">colnames</span><span class="p">(</span>london.data.cast<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">"Area"</span><span class="p">,</span> <span class="s">"total"</span><span class="p">)</span>
<a name="London Immigration.R-32"></a>
<a name="London Immigration.R-33"></a>london.data.cast <span class="o">&lt;-</span> london.data.cast<span class="p">[</span><span class="kp">order</span><span class="p">(</span>london.data.cast<span class="o">$</span>total<span class="p">,</span> decreasing<span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span> <span class="p">]</span>
<a name="London Immigration.R-34"></a>london.data.cast<span class="o">$</span>rank <span class="o">&lt;-</span> <span class="kp">as.numeric</span><span class="p">(</span><span class="kp">rank</span><span class="p">(</span>london.data.cast<span class="o">$</span>total<span class="p">))</span>
<a name="London Immigration.R-35"></a>
<a name="London Immigration.R-36"></a><span class="c1">### Drop the data that is extraneous (not elegant)</span>
<a name="London Immigration.R-37"></a>london.data.melt <span class="o">&lt;-</span> <span class="kp">merge</span><span class="p">(</span>london.data.melt<span class="p">,</span> london.data.cast<span class="p">,</span> by.x<span class="o">=</span><span class="s">"variable"</span><span class="p">,</span> by.y<span class="o">=</span><span class="s">"Area"</span><span class="p">)</span>
<a name="London Immigration.R-38"></a>london.data.melt <span class="o">&lt;-</span> <span class="kp">subset</span><span class="p">(</span>london.data.melt<span class="p">,</span> <span class="kp">as.numeric</span><span class="p">(</span><span class="kp">rank</span><span class="p">)</span><span class="o">&gt;=</span><span class="m">185</span><span class="p">)</span>
<a name="London Immigration.R-39"></a>
<a name="London Immigration.R-40"></a><span class="c1">### Merge on immigration data to the uk la map dataframe</span>
<a name="London Immigration.R-41"></a>ukmap.data <span class="o">&lt;-</span> <span class="kp">merge</span><span class="p">(</span>ukmap<span class="p">,</span> london.data.melt<span class="p">,</span> by.x<span class="o">=</span><span class="s">"id"</span><span class="p">,</span> by.y<span class="o">=</span><span class="s">"Area"</span><span class="p">)</span>
<a name="London Immigration.R-42"></a>ukmap.data <span class="o">&lt;-</span> ukmap.data<span class="p">[</span><span class="kp">order</span><span class="p">(</span>ukmap.data<span class="o">$</span><span class="kp">order</span><span class="p">),</span> <span class="p">]</span>
<a name="London Immigration.R-43"></a>
<a name="London Immigration.R-44"></a><span class="c1">### Drop other extraneous data</span>
<a name="London Immigration.R-45"></a>ukmap.data.sub <span class="o">&lt;-</span> <span class="kp">subset</span><span class="p">(</span>ukmap.data<span class="p">,</span> value<span class="o">&gt;</span><span class="m">0</span><span class="p">)</span>
<a name="London Immigration.R-46"></a>ukmap.data.sub <span class="o">&lt;-</span> <span class="kp">subset</span><span class="p">(</span>ukmap.data.sub<span class="p">,</span> group<span class="o">!=</span><span class="s">"London.1"</span><span class="p">)</span>
<a name="London Immigration.R-47"></a>
<a name="London Immigration.R-48"></a><span class="c1">### Merging the data above messes up the order of the points, so reorder to </span>
<a name="London Immigration.R-49"></a>ukmap.data.sub<span class="o">$</span>order <span class="o">&lt;-</span> <span class="kp">as.numeric</span><span class="p">(</span>ukmap.data.sub<span class="o">$</span><span class="kp">order</span><span class="p">)</span>
<a name="London Immigration.R-50"></a>ukmap.data.sub <span class="o">&lt;-</span> ukmap.data.sub<span class="p">[</span><span class="kp">order</span><span class="p">(</span>ukmap.data.sub<span class="o">$</span><span class="kp">rank</span><span class="p">,</span> ukmap.data.sub<span class="o">$</span>group<span class="p">,</span> ukmap.data.sub<span class="o">$</span><span class="kp">order</span><span class="p">),</span> <span class="p">]</span>
<a name="London Immigration.R-51"></a>
<a name="London Immigration.R-52"></a><span class="c1">#### Plot the map - facetted by country of origin</span>
<a name="London Immigration.R-53"></a>ggplot<span class="p">(</span>data <span class="o">=</span> ukmap.data.sub<span class="p">,</span> aes<span class="p">(</span>x <span class="o">=</span> long<span class="p">,</span> y <span class="o">=</span> lat<span class="p">,</span> fill <span class="o">=</span> cut_interval<span class="p">(</span><span class="kp">log</span><span class="p">(</span>value<span class="p">),</span> n <span class="o">=</span> <span class="m">9</span><span class="p">),</span> grouping <span class="o">=</span> group<span class="p">))</span><span class="o">+</span>
<a name="London Immigration.R-54"></a>		geom_polygon<span class="p">()</span><span class="o">+</span>
<a name="London Immigration.R-55"></a>		theme_bw<span class="p">()</span><span class="o">+</span>
<a name="London Immigration.R-56"></a>		geom_path<span class="p">(</span>colour<span class="o">=</span><span class="s">"grey"</span><span class="p">)</span><span class="o">+</span>
<a name="London Immigration.R-57"></a>		xlim<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">-0.6</span><span class="p">,</span> <span class="m">0.4</span><span class="p">))</span><span class="o">+</span>
<a name="London Immigration.R-58"></a>		ylim<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">51.25</span><span class="p">,</span> <span class="m">51.7</span><span class="p">))</span><span class="o">+</span>
<a name="London Immigration.R-59"></a>		facet_wrap<span class="p">(</span><span class="o">~</span>variable<span class="p">)</span><span class="o">+</span>
<a name="London Immigration.R-60"></a>		scale_fill_brewer<span class="p">(</span>palette <span class="o">=</span> <span class="s">"PuRd"</span><span class="p">,</span> label <span class="o">=</span> <span class="s">"Number of registered immigrants"</span><span class="p">)</span><span class="o">+</span>
<a name="London Immigration.R-61"></a>		xlab<span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span>
<a name="London Immigration.R-62"></a>		ylab<span class="p">(</span><span class="s">""</span><span class="p">)</span>
<a name="London Immigration.R-63"></a>		
<a name="London Immigration.R-64"></a>
<a name="London Immigration.R-65"></a>
</pre></div>
</td></tr></tbody></table></div><div class="bb-source-embed--footer"><div class="bb-source-embed--footer--primary-content"><a class="truncated-link" href="https://bitbucket.org/markbulling/open-source/src/ded7d7392a5c/London%20Immigration.R" title="London Immigration.R"><span>London Immigration.R</span></a><span>&nbsp;in&nbsp;</span><a class="truncated-link" href="https://bitbucket.org/markbulling/open-source"><span>Open Source</span></a><span class="bb-source-embed--footer--view-raw"><span class="hide-for-mobile">&nbsp;|&nbsp;</span><a href="https://bitbucket.org/markbulling/open-source/raw/ded7d7392a5c69f330b4d061ddb3aff522adb4d3/London%20Immigration.R">View raw</a></span></div><div class="bb-source-embed--footer--secondary-content">Code managed on <a href="https://bitbucket.org/">Atlassian Bitbucket</a></div><div class="clear"></div></div></div><p></p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->
		</div><!-- #content -->
	</section><!-- #primary -->

<div id="content-sidebar" class="content-sidebar widget-area" role="complementary">
	<aside id="text-3" class="widget widget_text">			<div class="textwidget"><center><img style="padding: 20px;" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/casapurple.png"></center></div>
		</aside><aside id="tag_cloud-4" class="widget widget_tag_cloud"><h1 class="widget-title">Categories</h1><div class="tagcloud"><a href="http://blogs.casa.ucl.ac.uk/category/abm/" class="tag-link-224" title="126 topics" style="font-size: 16.707317073171pt;">ABM</a>
<a href="http://blogs.casa.ucl.ac.uk/category/abm-examples/" class="tag-link-244" title="49 topics" style="font-size: 9.8780487804878pt;">ABM Examples</a>
<a href="http://blogs.casa.ucl.ac.uk/category/agent-based-models/" class="tag-link-666" title="46 topics" style="font-size: 9.3658536585366pt;">Agent Based Models</a>
<a href="http://blogs.casa.ucl.ac.uk/category/announcements-news/" class="tag-link-458" title="66 topics" style="font-size: 12.09756097561pt;">Announcements/ News</a>
<a href="http://blogs.casa.ucl.ac.uk/category/architecture/" class="tag-link-318" title="75 topics" style="font-size: 12.951219512195pt;">architecture</a>
<a href="http://blogs.casa.ucl.ac.uk/category/art/" class="tag-link-438" title="69 topics" style="font-size: 12.439024390244pt;">Art</a>
<a href="http://blogs.casa.ucl.ac.uk/category/augmented-reality/" class="tag-link-347" title="91 topics" style="font-size: 14.317073170732pt;">augmented reality</a>
<a href="http://blogs.casa.ucl.ac.uk/category/big-data/" class="tag-link-124" title="101 topics" style="font-size: 15.170731707317pt;">Big Data</a>
<a href="http://blogs.casa.ucl.ac.uk/category/bike-share/" class="tag-link-261" title="55 topics" style="font-size: 10.731707317073pt;">Bike Share</a>
<a href="http://blogs.casa.ucl.ac.uk/category/book/" class="tag-link-232" title="115 topics" style="font-size: 16.024390243902pt;">Book</a>
<a href="http://blogs.casa.ucl.ac.uk/category/casa/" class="tag-link-67" title="68 topics" style="font-size: 12.268292682927pt;">CASA</a>
<a href="http://blogs.casa.ucl.ac.uk/category/citizen-science/" class="tag-link-361" title="100 topics" style="font-size: 15pt;">citizen science</a>
<a href="http://blogs.casa.ucl.ac.uk/category/complexity/" class="tag-link-287" title="102 topics" style="font-size: 15.170731707317pt;">complexity</a>
<a href="http://blogs.casa.ucl.ac.uk/category/conference/" class="tag-link-78" title="80 topics" style="font-size: 13.463414634146pt;">Conference</a>
<a href="http://blogs.casa.ucl.ac.uk/category/conferences/" class="tag-link-459" title="83 topics" style="font-size: 13.634146341463pt;">Conferences</a>
<a href="http://blogs.casa.ucl.ac.uk/category/data/" class="tag-link-484" title="58 topics" style="font-size: 11.073170731707pt;">data</a>
<a href="http://blogs.casa.ucl.ac.uk/category/data-graphics/" class="tag-link-262" title="62 topics" style="font-size: 11.585365853659pt;">Data Graphics</a>
<a href="http://blogs.casa.ucl.ac.uk/category/emergence/" class="tag-link-290" title="41 topics" style="font-size: 8.5121951219512pt;">emergence</a>
<a href="http://blogs.casa.ucl.ac.uk/category/events/" class="tag-link-6" title="56 topics" style="font-size: 10.90243902439pt;">Events</a>
<a href="http://blogs.casa.ucl.ac.uk/category/extreme-citizen-science/" class="tag-link-360" title="49 topics" style="font-size: 9.8780487804878pt;">Extreme Citizen Science</a>
<a href="http://blogs.casa.ucl.ac.uk/category/flows/" class="tag-link-291" title="52 topics" style="font-size: 10.219512195122pt;">flows</a>
<a href="http://blogs.casa.ucl.ac.uk/category/gis/" class="tag-link-14" title="220 topics" style="font-size: 20.80487804878pt;">GIS</a>
<a href="http://blogs.casa.ucl.ac.uk/category/historic/" class="tag-link-831" title="44 topics" style="font-size: 9.0243902439024pt;">Historic</a>
<a href="http://blogs.casa.ucl.ac.uk/category/information/" class="tag-link-864" title="45 topics" style="font-size: 9.1951219512195pt;">Information</a>
<a href="http://blogs.casa.ucl.ac.uk/category/interactions/" class="tag-link-862" title="49 topics" style="font-size: 9.8780487804878pt;">Interactions</a>
<a href="http://blogs.casa.ucl.ac.uk/category/jobs/" class="tag-link-192" title="38 topics" style="font-size: 8pt;">Jobs</a>
<a href="http://blogs.casa.ucl.ac.uk/category/london/" class="tag-link-177" title="217 topics" style="font-size: 20.80487804878pt;">london</a>
<a href="http://blogs.casa.ucl.ac.uk/category/map/" class="tag-link-49" title="39 topics" style="font-size: 8.1707317073171pt;">map</a>
<a href="http://blogs.casa.ucl.ac.uk/category/mapping/" class="tag-link-26" title="56 topics" style="font-size: 10.90243902439pt;">mapping</a>
<a href="http://blogs.casa.ucl.ac.uk/category/netlogo/" class="tag-link-222" title="40 topics" style="font-size: 8.3414634146341pt;">Netlogo</a>
<a href="http://blogs.casa.ucl.ac.uk/category/networks/" class="tag-link-481" title="75 topics" style="font-size: 12.951219512195pt;">networks</a>
<a href="http://blogs.casa.ucl.ac.uk/category/news/" class="tag-link-4" title="52 topics" style="font-size: 10.219512195122pt;">News</a>
<a href="http://blogs.casa.ucl.ac.uk/category/openstreetmap/" class="tag-link-263" title="72 topics" style="font-size: 12.609756097561pt;">OpenStreetMap</a>
<a href="http://blogs.casa.ucl.ac.uk/category/papers/" class="tag-link-245" title="40 topics" style="font-size: 8.3414634146341pt;">Papers</a>
<a href="http://blogs.casa.ucl.ac.uk/category/planning/" class="tag-link-337" title="42 topics" style="font-size: 8.6829268292683pt;">planning</a>
<a href="http://blogs.casa.ucl.ac.uk/category/research/" class="tag-link-370" title="51 topics" style="font-size: 10.219512195122pt;">Research</a>
<a href="http://blogs.casa.ucl.ac.uk/category/review/" class="tag-link-320" title="113 topics" style="font-size: 16.024390243902pt;">review</a>
<a href="http://blogs.casa.ucl.ac.uk/category/scaling/" class="tag-link-753" title="46 topics" style="font-size: 9.3658536585366pt;">Scaling</a>
<a href="http://blogs.casa.ucl.ac.uk/category/smart-cities/" class="tag-link-763" title="83 topics" style="font-size: 13.634146341463pt;">Smart Cities</a>
<a href="http://blogs.casa.ucl.ac.uk/category/social-media/" class="tag-link-343" title="39 topics" style="font-size: 8.1707317073171pt;">social media</a>
<a href="http://blogs.casa.ucl.ac.uk/category/transport/" class="tag-link-395" title="41 topics" style="font-size: 8.5121951219512pt;">Transport</a>
<a href="http://blogs.casa.ucl.ac.uk/category/twitter/" class="tag-link-310" title="76 topics" style="font-size: 13.121951219512pt;">twitter</a>
<a href="http://blogs.casa.ucl.ac.uk/category/vgi/" class="tag-link-358" title="83 topics" style="font-size: 13.634146341463pt;">VGI</a>
<a href="http://blogs.casa.ucl.ac.uk/category/visualisation/" class="tag-link-60" title="255 topics" style="font-size: 22pt;">visualisation</a>
<a href="http://blogs.casa.ucl.ac.uk/category/volunteered-geographic-information/" class="tag-link-242" title="42 topics" style="font-size: 8.6829268292683pt;">Volunteered Geographic Information</a></div>
</aside>		<aside id="recent-posts-3" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="http://www.spatialcomplexity.info/archives/2562">Gravity</a>
							<span class="post-date">Saturday 3 October 2015</span>
						</li>
					<li>
				<a href="http://quaestio.blogweb.casa.ucl.ac.uk/requisite-knowledge/">22: Requisite Knowledge</a>
							<span class="post-date">Friday 2 October 2015</span>
						</li>
					<li>
				<a href="http://paul-longley.com/2015/10/online-digital-training-deep-finding-out-and-work-depending-knowing-improve-ingenuity-in-oakland-institution/">Online digital Training, Deep Finding out, And Work-Depending Knowing Improve Ingenuity in Oakland Institution</a>
							<span class="post-date">Friday 2 October 2015</span>
						</li>
					<li>
				<a href="http://paul-longley.com/2015/10/advanced-methods-to-developing-high-school-graduation-graduation-percentage-rates-school-and-career-readiness/">Advanced Methods to Developing High School Graduation Graduation Percentage rates, School and Career Readiness</a>
							<span class="post-date">Friday 2 October 2015</span>
						</li>
					<li>
				<a href="http://mappinglondon.co.uk/2015/the-london-blue-plaque-guide/">The London Blue Plaque Guide</a>
							<span class="post-date">Friday 2 October 2015</span>
						</li>
				</ul>
		</aside></div><!-- #content-sidebar -->
<div id="secondary">
		<h2 class="site-description">The latest outputs from researchers, alumni and friends at UCL CASA</h2>
	
	
		<div id="primary-sidebar" class="primary-sidebar widget-area" role="complementary">
		<aside id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://blogs.casa.ucl.ac.uk/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input class="search-field" placeholder="Search …" name="s" title="Search for:" type="search">
				</label>
				<input class="search-submit" value="Search" type="submit">
			</form></aside><aside id="linkcat-3" class="widget widget_links"><h1 class="widget-title">Contributors</h1>
	<ul class="xoxo blogroll">
<li><a href="http://networkingcity.blogspot.com/" title="  Research blog on urban environment and citizen  movements in complex networks">  Networking City</a></li>
<li><a href="http://garethsimons.tumblr.com/" title="The personal blog-space of Gareth Simons -&gt; architect | urbanist interested in performative simulation at the urban scale; space and flows as computational processes; information entropy &amp; irreversibility; and the ‘edge of chaos’.">@emergentcity</a></li>
<li><a href="http://news.google.com/news?hl=en&amp;gl=uk&amp;pz=1&amp;ned=us&amp;q=%5Cx22Center+for+Advanced+Spatial+Analysis%5Cx22" title="Google News">"Center for Advanced Spatial Analysis" – Google News</a></li>
<li><a href="http://www.complexcity.info/">A Science of Cities</a></li>
<li><a href="http://adamdennett.co.uk/">Adam Dennett</a></li>
<li><a href="http://www.alex-singleton.com/atom.xml">Alex Singleton</a></li>
<li><a href="http://blog.bigdatatoolkit.org/" title="Just another WordPress site">BDTK Blog</a></li>
<li><a href="http://projectcede.org/" title="Creating and Exploring Digital Empathy">CEDE</a></li>
<li><a href="http://citygeographics.org/" title="Urban visualisation and spatial analysis research blog by Duncan A Smith">CityGeographics: Visualising urban form, dynamics and sustainability</a></li>
<li><a href="http://crowdsimulation.blogspot.com/">Crowd Simulation</a></li>
<li><a href="http://aidcomplexity.blogs.casa.ucl.ac.uk/" title="Using Data, Networks and Complexity to Study Trade, Aid, Economics">Data-Driven Economics</a></li>
<li><a href="http://blog.datashine.org.uk/" title="Part of the ESRC BODMAS project at UCL">DataShine Blog</a></li>
<li><a href="http://www.digitalurban.org/" title="Smart Cities, Data, Modelling and Visualisation from The Bartlett Centre for Advanced Spatial Analysis, University College London">digital urban</a></li>
<li><a href="http://pablomateos.com/" title="Lecturer in Human Geography, University College London">Dr Pablo Mateos</a></li>
<li><a href="http://en-topia.blogspot.com/" title="digital tools for urban visualizations">en-topia</a></li>
<li><a href="http://enfolding.blogs.casa.ucl.ac.uk/" title="Global Dynamics and Complex Systems">ENFOLDing » blog</a></li>
<li><a href="http://genesis.blogs.casa.ucl.ac.uk/" title="Digital Social Research">GENeSIS</a></li>
<li><a href="http://blog.mackerron.com/" title="GIS, software development, and other snippets">George MacKerron: code blog</a></li>
<li><a href="http://gisplusar.blogspot.com/">GIS + AR (Augmented Reality)</a></li>
<li><a href="http://www.gisagents.org/" title="This is a research site focused around my interests in Geographical Information Science (GIS) and Agent-Based Modeling (ABM).">GIS and Agent-Based Modeling</a></li>
<li><a href="https://doublebyteblog.wordpress.com/" title="Coding “hard”, with the heart… :-)">heartcode</a></li>
<li><a href="http://mapblog.in/">mapblogin'</a></li>
<li><a href="http://mappinglondon.co.uk/" title="Highlighting the best London maps.">Mapping London</a></li>
<li><a href="http://www.mechanicity.info/" title="An ERC Advanced Grant">Mechanicity</a></li>
<li><a href="http://areaclassification.org.uk/" title="Open and Free Geodemographics">Output Area Classification User Group – OAC</a></li>
<li><a href="http://paul-longley.com/" title="Professor of Geographic Information Science, University College London">Paul Longley</a></li>
<li><a href="http://www.reades.com/" title="People, Data, Place">Placetique</a></li>
<li><a href="https://povesham.wordpress.com/" title="Geospatial Technologies, GIScience, Citizen Science &amp; Environmental Information">Po Ve Sham – Muki Haklay's personal blog</a></li>
<li><a href="http://popgeog.org/" title="PGRG – Royal Geographical Society with Institute of British Geographers">Population Geography Research Group</a></li>
<li><a href="http://www.hannahfry.co.uk/blog/" title="Dr. of fluid dynamics, researcher of complexity theory and all round bad-ass.">Python – Hannah Fry</a></li>
<li><a href="http://quaestio.blogweb.casa.ucl.ac.uk/" title="research: questioning, inquiring, seeking, searching and scrutinising">Quaestio</a></li>
<li><a href="http://quantile.info/" title="Quantitative Teaching, Research and Outreach in Geography">QuanTile</a></li>
<li><a href="http://qmrg.org.uk/">Quantitative Methods Research Group (QMRG) – Royal Geographical Society with IBG</a></li>
<li><a href="http://simone.blogs.casa.ucl.ac.uk/" title="UCL QASER Lab &amp; CASA Research Associate, University College London">Simone Caschili</a></li>
<li><a href="http://simulacra.blogs.casa.ucl.ac.uk/" title="Showcasing land use transport modelling, urban complexity and sustainability research from the Centre for Advanced Spatial Analysis, University College London">Simulacra</a></li>
<li><a href="http://www.spatialcomplexity.info/" title="Mainly Based on my Lectures on Models, Complexity, and Smart Cities at ASU, CUSP at NYU, Ritsumeikan, Tel Aviv, and UCL, with blogging odds and ends thrown in for good measure">Smart Cities</a></li>
<li><a href="https://snakesonabrain.wordpress.com/" title="Attempting scientific and mathematical programming in Python.">Snakes on a brain</a></li>
<li><a href="https://sociablephysics.wordpress.com/" title="Because “social physicist” is not an oxymoron.">Sociable Physics</a></li>
<li><a href="http://www.scoop.it/t/spatial-analysis" title="All the new curated posts for the topic: Spatial Analysis">Spatial Analysis | Scoop.it</a></li>
<li><a href="http://spatial.ly/" title="Spatial Analysis, Visualisation and Resources">Spatial.ly</a></li>
<li><a href="#">Steven Gray</a></li>
<li><a href="http://oobrien.com/" title="A blog by Oliver O’Brien, researcher at UCL Department of Geography. Digital cartography, data visualisation.">Suprageography</a></li>
<li><a href="http://www.geotalisman.org/" title="Geospatial Data Analysis and Simulation">Talisman</a></li>
<li><a href="http://urbancortex.org/" title="brains, emotions and urban behaviour">the urban cortex</a></li>
<li><a href="http://topometries.blogspot.com/" title="Land-use dynamics, pedestrian behaviour and transport simulation, multi-agent systems and spatial morphology">topometries</a></li>
<li><a href="http://www.urbagram.net/v1/show/HomePage" title="An Instiki wiki">Urbagram</a></li>
<li><a href="http://urbanmovements.co.uk/" title="Flows, Behaviour and Networks in the City">UrbanMovements</a></li>
<li><a href="http://urbantick.blogspot.com/">UrbanTick</a></li>
<li><a href="http://danieljlewis.org/" title="A Geography/GIS blog by Daniel J Lewis">Volunteered Geographic Information</a></li>

	</ul>
</aside>
<aside id="archives-3" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
	<li><a href="http://blogs.casa.ucl.ac.uk/2015/10/">October 2015</a>&nbsp;(6)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2015/09/">September 2015</a>&nbsp;(36)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2015/08/">August 2015</a>&nbsp;(26)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2015/07/">July 2015</a>&nbsp;(46)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2015/06/">June 2015</a>&nbsp;(39)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2015/05/">May 2015</a>&nbsp;(36)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2015/04/">April 2015</a>&nbsp;(59)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2015/03/">March 2015</a>&nbsp;(60)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2015/02/">February 2015</a>&nbsp;(38)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2015/01/">January 2015</a>&nbsp;(29)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/12/">December 2014</a>&nbsp;(44)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/11/">November 2014</a>&nbsp;(30)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/10/">October 2014</a>&nbsp;(49)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/09/">September 2014</a>&nbsp;(99)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/08/">August 2014</a>&nbsp;(23)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/07/">July 2014</a>&nbsp;(38)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/06/">June 2014</a>&nbsp;(42)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/05/">May 2014</a>&nbsp;(46)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/04/">April 2014</a>&nbsp;(48)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/03/">March 2014</a>&nbsp;(56)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/02/">February 2014</a>&nbsp;(65)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2014/01/">January 2014</a>&nbsp;(57)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/12/">December 2013</a>&nbsp;(38)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/11/">November 2013</a>&nbsp;(59)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/10/">October 2013</a>&nbsp;(78)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/09/">September 2013</a>&nbsp;(82)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/08/">August 2013</a>&nbsp;(72)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/07/">July 2013</a>&nbsp;(69)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/06/">June 2013</a>&nbsp;(79)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/05/">May 2013</a>&nbsp;(62)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/04/">April 2013</a>&nbsp;(62)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/03/">March 2013</a>&nbsp;(45)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/02/">February 2013</a>&nbsp;(45)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2013/01/">January 2013</a>&nbsp;(43)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/12/">December 2012</a>&nbsp;(33)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/11/">November 2012</a>&nbsp;(39)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/10/">October 2012</a>&nbsp;(107)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/09/">September 2012</a>&nbsp;(28)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/08/">August 2012</a>&nbsp;(58)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/07/">July 2012</a>&nbsp;(84)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/06/">June 2012</a>&nbsp;(64)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/05/">May 2012</a>&nbsp;(58)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/04/">April 2012</a>&nbsp;(54)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/03/">March 2012</a>&nbsp;(64)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/02/">February 2012</a>&nbsp;(76)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2012/01/">January 2012</a>&nbsp;(68)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/12/">December 2011</a>&nbsp;(80)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/11/">November 2011</a>&nbsp;(88)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/10/">October 2011</a>&nbsp;(78)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/09/">September 2011</a>&nbsp;(38)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/08/">August 2011</a>&nbsp;(58)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/07/">July 2011</a>&nbsp;(95)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/06/">June 2011</a>&nbsp;(85)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/05/">May 2011</a>&nbsp;(64)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/04/">April 2011</a>&nbsp;(58)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/03/">March 2011</a>&nbsp;(115)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/02/">February 2011</a>&nbsp;(67)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2011/01/">January 2011</a>&nbsp;(29)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/12/">December 2010</a>&nbsp;(17)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/11/">November 2010</a>&nbsp;(28)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/10/">October 2010</a>&nbsp;(14)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/09/">September 2010</a>&nbsp;(21)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/08/">August 2010</a>&nbsp;(13)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/07/">July 2010</a>&nbsp;(5)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/06/">June 2010</a>&nbsp;(29)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/05/">May 2010</a>&nbsp;(21)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/04/">April 2010</a>&nbsp;(8)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/03/">March 2010</a>&nbsp;(4)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/02/">February 2010</a>&nbsp;(6)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2010/01/">January 2010</a>&nbsp;(3)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/12/">December 2009</a>&nbsp;(4)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/11/">November 2009</a>&nbsp;(1)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/10/">October 2009</a>&nbsp;(1)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/09/">September 2009</a>&nbsp;(4)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/08/">August 2009</a>&nbsp;(7)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/07/">July 2009</a>&nbsp;(1)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/06/">June 2009</a>&nbsp;(2)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/05/">May 2009</a>&nbsp;(3)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/04/">April 2009</a>&nbsp;(14)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/03/">March 2009</a>&nbsp;(3)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/02/">February 2009</a>&nbsp;(3)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2009/01/">January 2009</a>&nbsp;(2)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2008/12/">December 2008</a>&nbsp;(3)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2008/11/">November 2008</a>&nbsp;(11)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2008/08/">August 2008</a>&nbsp;(1)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2008/07/">July 2008</a>&nbsp;(4)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2008/06/">June 2008</a>&nbsp;(5)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/2001/03/">March 2001</a>&nbsp;(1)</li>
	<li><a href="http://blogs.casa.ucl.ac.uk/1991/03/">March 1991</a>&nbsp;(1)</li>
		</ul>
</aside>	</div><!-- #primary-sidebar -->
	</div><!-- #secondary -->

		</div><!-- #main -->

		<footer id="colophon" class="site-footer" role="contentinfo">

			
<div id="supplementary">
	<div style="position: relative; height: 1308px;" id="footer-sidebar" class="footer-sidebar widget-area masonry" role="complementary">
		<aside style="position: absolute; left: 0px; top: 48px;" id="search-5" class="widget widget_search masonry-brick"><form role="search" method="get" class="search-form" action="http://blogs.casa.ucl.ac.uk/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input class="search-field" placeholder="Search …" name="s" title="Search for:" type="search">
				</label>
				<input class="search-submit" value="Search" type="submit">
			</form></aside><aside style="position: absolute; left: 315px; top: 48px;" id="linkcat-3" class="widget widget_links masonry-brick"><h1 class="widget-title">Contributors</h1>
	<ul class="xoxo blogroll">
<li><a href="http://networkingcity.blogspot.com/" title="  Research blog on urban environment and citizen  movements in complex networks">  Networking City</a></li>
<li><a href="http://garethsimons.tumblr.com/" title="The personal blog-space of Gareth Simons -&gt; architect | urbanist interested in performative simulation at the urban scale; space and flows as computational processes; information entropy &amp; irreversibility; and the ‘edge of chaos’.">@emergentcity</a></li>
<li><a href="http://news.google.com/news?hl=en&amp;gl=uk&amp;pz=1&amp;ned=us&amp;q=%5Cx22Center+for+Advanced+Spatial+Analysis%5Cx22" title="Google News">"Center for Advanced Spatial Analysis" – Google News</a></li>
<li><a href="http://www.complexcity.info/">A Science of Cities</a></li>
<li><a href="http://adamdennett.co.uk/">Adam Dennett</a></li>
<li><a href="http://www.alex-singleton.com/atom.xml">Alex Singleton</a></li>
<li><a href="http://blog.bigdatatoolkit.org/" title="Just another WordPress site">BDTK Blog</a></li>
<li><a href="http://projectcede.org/" title="Creating and Exploring Digital Empathy">CEDE</a></li>
<li><a href="http://citygeographics.org/" title="Urban visualisation and spatial analysis research blog by Duncan A Smith">CityGeographics: Visualising urban form, dynamics and sustainability</a></li>
<li><a href="http://crowdsimulation.blogspot.com/">Crowd Simulation</a></li>
<li><a href="http://aidcomplexity.blogs.casa.ucl.ac.uk/" title="Using Data, Networks and Complexity to Study Trade, Aid, Economics">Data-Driven Economics</a></li>
<li><a href="http://blog.datashine.org.uk/" title="Part of the ESRC BODMAS project at UCL">DataShine Blog</a></li>
<li><a href="http://www.digitalurban.org/" title="Smart Cities, Data, Modelling and Visualisation from The Bartlett Centre for Advanced Spatial Analysis, University College London">digital urban</a></li>
<li><a href="http://pablomateos.com/" title="Lecturer in Human Geography, University College London">Dr Pablo Mateos</a></li>
<li><a href="http://en-topia.blogspot.com/" title="digital tools for urban visualizations">en-topia</a></li>
<li><a href="http://enfolding.blogs.casa.ucl.ac.uk/" title="Global Dynamics and Complex Systems">ENFOLDing » blog</a></li>
<li><a href="http://genesis.blogs.casa.ucl.ac.uk/" title="Digital Social Research">GENeSIS</a></li>
<li><a href="http://blog.mackerron.com/" title="GIS, software development, and other snippets">George MacKerron: code blog</a></li>
<li><a href="http://gisplusar.blogspot.com/">GIS + AR (Augmented Reality)</a></li>
<li><a href="http://www.gisagents.org/" title="This is a research site focused around my interests in Geographical Information Science (GIS) and Agent-Based Modeling (ABM).">GIS and Agent-Based Modeling</a></li>
<li><a href="https://doublebyteblog.wordpress.com/" title="Coding “hard”, with the heart… :-)">heartcode</a></li>
<li><a href="http://mapblog.in/">mapblogin'</a></li>
<li><a href="http://mappinglondon.co.uk/" title="Highlighting the best London maps.">Mapping London</a></li>
<li><a href="http://www.mechanicity.info/" title="An ERC Advanced Grant">Mechanicity</a></li>
<li><a href="http://areaclassification.org.uk/" title="Open and Free Geodemographics">Output Area Classification User Group – OAC</a></li>
<li><a href="http://paul-longley.com/" title="Professor of Geographic Information Science, University College London">Paul Longley</a></li>
<li><a href="http://www.reades.com/" title="People, Data, Place">Placetique</a></li>
<li><a href="https://povesham.wordpress.com/" title="Geospatial Technologies, GIScience, Citizen Science &amp; Environmental Information">Po Ve Sham – Muki Haklay's personal blog</a></li>
<li><a href="http://popgeog.org/" title="PGRG – Royal Geographical Society with Institute of British Geographers">Population Geography Research Group</a></li>
<li><a href="http://www.hannahfry.co.uk/blog/" title="Dr. of fluid dynamics, researcher of complexity theory and all round bad-ass.">Python – Hannah Fry</a></li>
<li><a href="http://quaestio.blogweb.casa.ucl.ac.uk/" title="research: questioning, inquiring, seeking, searching and scrutinising">Quaestio</a></li>
<li><a href="http://quantile.info/" title="Quantitative Teaching, Research and Outreach in Geography">QuanTile</a></li>
<li><a href="http://qmrg.org.uk/">Quantitative Methods Research Group (QMRG) – Royal Geographical Society with IBG</a></li>
<li><a href="http://simone.blogs.casa.ucl.ac.uk/" title="UCL QASER Lab &amp; CASA Research Associate, University College London">Simone Caschili</a></li>
<li><a href="http://simulacra.blogs.casa.ucl.ac.uk/" title="Showcasing land use transport modelling, urban complexity and sustainability research from the Centre for Advanced Spatial Analysis, University College London">Simulacra</a></li>
<li><a href="http://www.spatialcomplexity.info/" title="Mainly Based on my Lectures on Models, Complexity, and Smart Cities at ASU, CUSP at NYU, Ritsumeikan, Tel Aviv, and UCL, with blogging odds and ends thrown in for good measure">Smart Cities</a></li>
<li><a href="https://snakesonabrain.wordpress.com/" title="Attempting scientific and mathematical programming in Python.">Snakes on a brain</a></li>
<li><a href="https://sociablephysics.wordpress.com/" title="Because “social physicist” is not an oxymoron.">Sociable Physics</a></li>
<li><a href="http://www.scoop.it/t/spatial-analysis" title="All the new curated posts for the topic: Spatial Analysis">Spatial Analysis | Scoop.it</a></li>
<li><a href="http://spatial.ly/" title="Spatial Analysis, Visualisation and Resources">Spatial.ly</a></li>
<li><a href="#">Steven Gray</a></li>
<li><a href="http://oobrien.com/" title="A blog by Oliver O’Brien, researcher at UCL Department of Geography. Digital cartography, data visualisation.">Suprageography</a></li>
<li><a href="http://www.geotalisman.org/" title="Geospatial Data Analysis and Simulation">Talisman</a></li>
<li><a href="http://urbancortex.org/" title="brains, emotions and urban behaviour">the urban cortex</a></li>
<li><a href="http://topometries.blogspot.com/" title="Land-use dynamics, pedestrian behaviour and transport simulation, multi-agent systems and spatial morphology">topometries</a></li>
<li><a href="http://www.urbagram.net/v1/show/HomePage" title="An Instiki wiki">Urbagram</a></li>
<li><a href="http://urbanmovements.co.uk/" title="Flows, Behaviour and Networks in the City">UrbanMovements</a></li>
<li><a href="http://urbantick.blogspot.com/">UrbanTick</a></li>
<li><a href="http://danieljlewis.org/" title="A Geography/GIS blog by Daniel J Lewis">Volunteered Geographic Information</a></li>

	</ul>
</aside>
	</div><!-- #footer-sidebar -->
</div><!-- #supplementary -->

			<div class="site-info">
								<a href="https://wordpress.org/">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

	<script type="text/javascript" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/masonry.js"></script>
<script type="text/javascript" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/jquery.js"></script>
<script type="text/javascript" src="R%20spatial%20%7C%20The%20CASA%20Blog%20Network_files/functions.js"></script>

</body></html>
