
document.write('<link rel="stylesheet" href="https://d3oaxc4q5k2d6q.cloudfront.net/m/0c995c25e487/css/entry/embed.css" />');
document.write('<div class="bb-source-embed"><div class="bb-source-embed--code-wrapper">');

document.write('\u003Ctable class\u003D\u0022highlighttable\u0022\u003E\u003Ctr\u003E\u003Ctd class\u003D\u0022linenos\u0022\u003E\u003Cdiv class\u003D\u0022linenodiv\u0022\u003E\u003Cpre\u003E\u003Ca href\u003D\u0022#London%20Immigration.R\u002D1\u0022\u003E 1\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D2\u0022\u003E 2\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D3\u0022\u003E 3\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D4\u0022\u003E 4\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D5\u0022\u003E 5\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D6\u0022\u003E 6\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D7\u0022\u003E 7\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D8\u0022\u003E 8\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D9\u0022\u003E 9\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D10\u0022\u003E10\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D11\u0022\u003E11\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D12\u0022\u003E12\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D13\u0022\u003E13\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D14\u0022\u003E14\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D15\u0022\u003E15\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D16\u0022\u003E16\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D17\u0022\u003E17\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D18\u0022\u003E18\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D19\u0022\u003E19\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D20\u0022\u003E20\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D21\u0022\u003E21\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D22\u0022\u003E22\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D23\u0022\u003E23\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D24\u0022\u003E24\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D25\u0022\u003E25\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D26\u0022\u003E26\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D27\u0022\u003E27\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D28\u0022\u003E28\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D29\u0022\u003E29\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D30\u0022\u003E30\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D31\u0022\u003E31\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D32\u0022\u003E32\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D33\u0022\u003E33\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D34\u0022\u003E34\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D35\u0022\u003E35\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D36\u0022\u003E36\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D37\u0022\u003E37\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D38\u0022\u003E38\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D39\u0022\u003E39\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D40\u0022\u003E40\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D41\u0022\u003E41\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D42\u0022\u003E42\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D43\u0022\u003E43\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D44\u0022\u003E44\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D45\u0022\u003E45\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D46\u0022\u003E46\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D47\u0022\u003E47\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D48\u0022\u003E48\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D49\u0022\u003E49\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D50\u0022\u003E50\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D51\u0022\u003E51\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D52\u0022\u003E52\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D53\u0022\u003E53\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D54\u0022\u003E54\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D55\u0022\u003E55\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D56\u0022\u003E56\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D57\u0022\u003E57\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D58\u0022\u003E58\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D59\u0022\u003E59\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D60\u0022\u003E60\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D61\u0022\u003E61\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D62\u0022\u003E62\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D63\u0022\u003E63\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D64\u0022\u003E64\u003C/a\u003E\u000A\u003Ca href\u003D\u0022#London%20Immigration.R\u002D65\u0022\u003E65\u003C/a\u003E\u003C/pre\u003E\u003C/div\u003E\u003C/td\u003E\u003Ctd class\u003D\u0022code\u0022\u003E\u003Cdiv class\u003D\u0022highlight\u0022\u003E\u003Cpre\u003E\u003Ca name\u003D\u0022London%20Immigration.R\u002D1\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E##################################################\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D2\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E## London Data Maps Visualisation               ##\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D3\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E## Author: Mark Bulling                         ##\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D4\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E## Date: 2011\u002D06\u002D01                             ##\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D5\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E## Comments: code to generate maps of London    ##\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D6\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E##################################################\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D7\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D8\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022kn\u0022\u003Elibrary\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Eggplot2\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D9\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022kn\u0022\u003Elibrary\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Emaps\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D10\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022kn\u0022\u003Elibrary\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Esp\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D11\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D12\u0022\u003E\u003C/a\u003EgpclibPermit\u003Cspan class\u003D\u0022p\u0022\u003E()\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D13\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D14\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E#### Read in shapefiles for UK LA\u0026#39\u003Bs from GADM\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D15\u0022\u003E\u003C/a\u003Econ \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022kp\u0022\u003Eurl\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003Bhttp://www.gadm.org/data/rda/GBR_adm2.RData\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D16\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Eprint\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Eload\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Econ\u003Cspan class\u003D\u0022p\u0022\u003E))\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D17\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Eclose\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Econ\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D18\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D19\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E#### Fortify this using ggplot2 features \u002D this turns the shapefiles into a dataframe\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D20\u0022\u003E\u003C/a\u003Eukmap \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E fortify.SpatialPolygonsDataFrame\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Egadm\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E region\u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BNAME_2\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D21\u0022\u003E\u003C/a\u003Eukmap\u003Cspan class\u003D\u0022o\u0022\u003E$\u003C/span\u003Eorder \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022kp\u0022\u003Erownames\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Eukmap\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E \u003Cspan class\u003D\u0022c1\u0022\u003E### Order is important when drawing the map\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D22\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D23\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E#### Read in the immigration data from London datastore\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D24\u0022\u003E\u003C/a\u003Eurl \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003Bhttp://data.london.gov.uk/datafiles/demographics/nino\u002Dregistrations\u002Doverseas\u002Dborough\u002D2009.csv\u0026quot\u003B\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D25\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D26\u0022\u003E\u003C/a\u003Elondon.data \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E read.csv\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Eurl\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D27\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D28\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E### Melt the data to turn it into something that can be cast\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D29\u0022\u003E\u003C/a\u003Elondon.data.melt \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E melt\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Ex\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E id\u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022kt\u0022\u003Ec\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BCode\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E \u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BArea\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E \u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BTotal.Number.of.Registrations\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E \u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BMYE.Working.age.2008\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E))\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D30\u0022\u003E\u003C/a\u003Elondon.data.cast \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E cast\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Elondon.data.melt\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E variable\u003Cspan class\u003D\u0022o\u0022\u003E~\u003C/span\u003E\u003Cspan class\u003D\u0022m\u0022\u003E.\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E fun.aggregate\u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Esum\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D31\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Ecolnames\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Elondon.data.cast\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022kt\u0022\u003Ec\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BArea\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E \u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003Btotal\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D32\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D33\u0022\u003E\u003C/a\u003Elondon.data.cast \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E london.data.cast\u003Cspan class\u003D\u0022p\u0022\u003E[\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Eorder\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Elondon.data.cast\u003Cspan class\u003D\u0022o\u0022\u003E$\u003C/span\u003Etotal\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E decreasing\u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022kc\u0022\u003ETRUE\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E),\u003C/span\u003E \u003Cspan class\u003D\u0022p\u0022\u003E]\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D34\u0022\u003E\u003C/a\u003Elondon.data.cast\u003Cspan class\u003D\u0022o\u0022\u003E$\u003C/span\u003Erank \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022kp\u0022\u003Eas.numeric\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Erank\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Elondon.data.cast\u003Cspan class\u003D\u0022o\u0022\u003E$\u003C/span\u003Etotal\u003Cspan class\u003D\u0022p\u0022\u003E))\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D35\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D36\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E### Drop the data that is extraneous (not elegant)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D37\u0022\u003E\u003C/a\u003Elondon.data.melt \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022kp\u0022\u003Emerge\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Elondon.data.melt\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E london.data.cast\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E by.x\u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003Bvariable\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E by.y\u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BArea\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D38\u0022\u003E\u003C/a\u003Elondon.data.melt \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022kp\u0022\u003Esubset\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Elondon.data.melt\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E \u003Cspan class\u003D\u0022kp\u0022\u003Eas.numeric\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Erank\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E\u0026gt\u003B\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022m\u0022\u003E185\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D39\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D40\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E### Merge on immigration data to the uk la map dataframe\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D41\u0022\u003E\u003C/a\u003Eukmap.data \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022kp\u0022\u003Emerge\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Eukmap\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E london.data.melt\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E by.x\u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003Bid\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E by.y\u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BArea\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D42\u0022\u003E\u003C/a\u003Eukmap.data \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E ukmap.data\u003Cspan class\u003D\u0022p\u0022\u003E[\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Eorder\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Eukmap.data\u003Cspan class\u003D\u0022o\u0022\u003E$\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Eorder\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E),\u003C/span\u003E \u003Cspan class\u003D\u0022p\u0022\u003E]\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D43\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D44\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E### Drop other extraneous data\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D45\u0022\u003E\u003C/a\u003Eukmap.data.sub \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022kp\u0022\u003Esubset\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Eukmap.data\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E value\u003Cspan class\u003D\u0022o\u0022\u003E\u0026gt\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022m\u0022\u003E0\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D46\u0022\u003E\u003C/a\u003Eukmap.data.sub \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022kp\u0022\u003Esubset\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Eukmap.data.sub\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E group\u003Cspan class\u003D\u0022o\u0022\u003E!\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BLondon.1\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D47\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D48\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E### Merging the data above messes up the order of the points, so reorder to \u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D49\u0022\u003E\u003C/a\u003Eukmap.data.sub\u003Cspan class\u003D\u0022o\u0022\u003E$\u003C/span\u003Eorder \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E \u003Cspan class\u003D\u0022kp\u0022\u003Eas.numeric\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Eukmap.data.sub\u003Cspan class\u003D\u0022o\u0022\u003E$\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Eorder\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D50\u0022\u003E\u003C/a\u003Eukmap.data.sub \u003Cspan class\u003D\u0022o\u0022\u003E\u0026lt\u003B\u002D\u003C/span\u003E ukmap.data.sub\u003Cspan class\u003D\u0022p\u0022\u003E[\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Eorder\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Eukmap.data.sub\u003Cspan class\u003D\u0022o\u0022\u003E$\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Erank\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E ukmap.data.sub\u003Cspan class\u003D\u0022o\u0022\u003E$\u003C/span\u003Egroup\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E ukmap.data.sub\u003Cspan class\u003D\u0022o\u0022\u003E$\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Eorder\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E),\u003C/span\u003E \u003Cspan class\u003D\u0022p\u0022\u003E]\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D51\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D52\u0022\u003E\u003C/a\u003E\u003Cspan class\u003D\u0022c1\u0022\u003E#### Plot the map \u002D facetted by country of origin\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D53\u0022\u003E\u003C/a\u003Eggplot\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Edata \u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E ukmap.data.sub\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E aes\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Ex \u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E long\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E y \u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E lat\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E fill \u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E cut_interval\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022kp\u0022\u003Elog\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Evalue\u003Cspan class\u003D\u0022p\u0022\u003E),\u003C/span\u003E n \u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E \u003Cspan class\u003D\u0022m\u0022\u003E9\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E),\u003C/span\u003E grouping \u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E group\u003Cspan class\u003D\u0022p\u0022\u003E))\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E+\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D54\u0022\u003E\u003C/a\u003E\u0009\u0009geom_polygon\u003Cspan class\u003D\u0022p\u0022\u003E()\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E+\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D55\u0022\u003E\u003C/a\u003E\u0009\u0009theme_bw\u003Cspan class\u003D\u0022p\u0022\u003E()\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E+\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D56\u0022\u003E\u003C/a\u003E\u0009\u0009geom_path\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Ecolour\u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003Bgrey\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E+\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D57\u0022\u003E\u003C/a\u003E\u0009\u0009xlim\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022kt\u0022\u003Ec\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022m\u0022\u003E\u002D0.6\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E \u003Cspan class\u003D\u0022m\u0022\u003E0.4\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E))\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E+\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D58\u0022\u003E\u003C/a\u003E\u0009\u0009ylim\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022kt\u0022\u003Ec\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022m\u0022\u003E51.25\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E \u003Cspan class\u003D\u0022m\u0022\u003E51.7\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E))\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E+\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D59\u0022\u003E\u003C/a\u003E\u0009\u0009facet_wrap\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E~\u003C/span\u003Evariable\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E+\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D60\u0022\u003E\u003C/a\u003E\u0009\u0009scale_fill_brewer\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003Epalette \u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E \u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BPuRd\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E,\u003C/span\u003E label \u003Cspan class\u003D\u0022o\u0022\u003E\u003D\u003C/span\u003E \u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003BNumber of registered immigrants\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E+\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D61\u0022\u003E\u003C/a\u003E\u0009\u0009xlab\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003B\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u003Cspan class\u003D\u0022o\u0022\u003E+\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D62\u0022\u003E\u003C/a\u003E\u0009\u0009ylab\u003Cspan class\u003D\u0022p\u0022\u003E(\u003C/span\u003E\u003Cspan class\u003D\u0022s\u0022\u003E\u0026quot\u003B\u0026quot\u003B\u003C/span\u003E\u003Cspan class\u003D\u0022p\u0022\u003E)\u003C/span\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D63\u0022\u003E\u003C/a\u003E\u0009\u0009\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D64\u0022\u003E\u003C/a\u003E\u000A\u003Ca name\u003D\u0022London%20Immigration.R\u002D65\u0022\u003E\u003C/a\u003E\u000A\u003C/pre\u003E\u003C/div\u003E\u000A\u003C/td\u003E\u003C/tr\u003E\u003C/table\u003E');

document.write('</div>');
document.write('<div class="bb-source-embed--footer">');
document.write('<div class="bb-source-embed--footer--primary-content">');
document.write('<a class="truncated-link" href="https://bitbucket.org/markbulling/open-source/src/ded7d7392a5c/London%20Immigration.R" title="London Immigration.R">');
document.write('<span>London Immigration.R</span>');
document.write('</a>');

document.write('<span>&nbsp;in&nbsp;</span><a class="truncated-link" href="https://bitbucket.org/markbulling/open-source"><span>Open Source</span></a>');

document.write('<span class="bb-source-embed--footer--view-raw">');
document.write('<span class="hide-for-mobile">&nbsp;|&nbsp;</span><a href="https://bitbucket.org/markbulling/open-source/raw/ded7d7392a5c69f330b4d061ddb3aff522adb4d3/London%20Immigration.R">View raw</a>');
document.write('</span>');
document.write('</div>');
document.write('<div class="bb-source-embed--footer--secondary-content">Code managed on <a href="https://bitbucket.org/">Atlassian Bitbucket</a></div>');
document.write('<div class="clear"></div>');
document.write('</div>');
document.write('</div>');
